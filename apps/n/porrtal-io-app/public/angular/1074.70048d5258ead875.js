/*
Copyright 2022 Comcast Cable Communications Management, LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[1074],{71074:(H,m,l)=>{l.r(m),l.d(m,{populateOperationalLayers:()=>M});var o=l(15861),C=l(46160),x=(l(8314),l(10699)),L=l(30164),W=l(55463);function F(e){return G(e,"notes")}function b(e){return G(e,"route")}function G(e,r){return!(!e.layerType||"ArcGISFeatureLayer"!==e.layerType)&&e.featureCollectionType===r}var V=l(7534),O=l(39683);function M(e,r,a){return p.apply(this,arguments)}function p(){return(p=(0,o.Z)(function*(e,r,a){if(!r)return;const y=[];for(const t of r){const n=E(t,a);y.push("GroupLayer"===t.layerType?P(n,t,a):n)}const i=yield(0,x.as)(y);for(const t of i)!t.value||a.filter&&!a.filter(t.value)||e.add(t.value)})).apply(this,arguments)}const U={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",PointCloudLayer:"PointCloudLayer",ArcGISSceneServiceLayer:"SceneLayer",IntegratedMeshLayer:"IntegratedMeshLayer",OGCFeatureLayer:"OGCFeatureLayer",BuildingSceneLayer:"BuildingSceneLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",GeoJSON:"GeoJSONLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",VectorTileLayer:"VectorTileLayer",WFS:"WFSLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer",KML:"KMLLayer",RasterDataLayer:"UnsupportedLayer",Voxel:"VoxelLayer",LineOfSightLayer:"LineOfSightLayer"},B={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer",RasterDataElevationLayer:"UnsupportedLayer"},w={ArcGISTiledMapServiceLayer:"TileLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",OpenStreetMap:"OpenStreetMapLayer",WebTiledLayer:"WebTileLayer",VectorTileLayer:"VectorTileLayer",ArcGISImageServiceLayer:"UnsupportedLayer",WMS:"UnsupportedLayer",ArcGISMapServiceLayer:"UnsupportedLayer",DefaultTileLayer:"TileLayer"},D={ArcGISAnnotationLayer:"UnsupportedLayer",ArcGISDimensionLayer:"UnsupportedLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",CSV:"CSVLayer",DefaultTileLayer:"TileLayer",GeoRSS:"GeoRSSLayer",GeoJSON:"GeoJSONLayer",GroupLayer:"GroupLayer",KML:"KMLLayer",OGCFeatureLayer:"OGCFeatureLayer",SubtypeGroupLayer:"UnsupportedLayer",VectorTileLayer:"VectorTileLayer",WFS:"WFSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},R={ArcGISFeatureLayer:"FeatureLayer"},Z={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"};function E(e,r){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)(function*(e,r){return N(yield J(e,r),e,r)})).apply(this,arguments)}function N(e,r,a){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)(function*(e,r,a){const y=new e;return y.read(r,a.context),"group"===y.type&&v(r)&&(yield k(y,r,a.context)),yield(0,O.y)(y,a.context),y})).apply(this,arguments)}function J(e,r){return T.apply(this,arguments)}function T(){return(T=(0,o.Z)(function*(e,r){const a=r.context,y=K(a);let i=e.layerType||e.type;!i&&r&&r.defaultLayerType&&(i=r.defaultLayerType);const t=y[i];let n=t?L.T[t]:L.T.UnknownLayer;if(A(e)){const g=a?.portal;if(e.itemId){const u=new W.default({id:e.itemId,portal:g});yield u.load();const s=(yield(0,V.selectLayerClassPath)(u)).className||"UnknownLayer";n=L.T[s]}}else"ArcGISFeatureLayer"===i?F(e)?n=L.T.MapNotesLayer:b(e)?n=L.T.RouteLayer:v(e)&&(n=L.T.GroupLayer):e.wmtsInfo&&e.wmtsInfo.url&&e.wmtsInfo.layerIdentifier?n=L.T.WMTSLayer:"WFS"===i&&"2.0.0"!==e.wfsInfo.version&&(n=L.T.UnsupportedLayer);return n()})).apply(this,arguments)}function v(e){return"ArcGISFeatureLayer"===e.layerType&&!A(e)&&(e.featureCollection?.layers?.length??0)>1}function A(e){return"Feature Collection"===e.type}function K(e){let r;if("web-scene"===e.origin)switch(e.layerContainerType){case"basemap":r=w;break;case"ground":r=B;break;default:r=U}else switch(e.layerContainerType){case"basemap":r=Z;break;case"tables":r=R;break;default:r=D}return r}function P(e,r,a){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)(function*(e,r,a){const y=new C.Z,i=M(y,Array.isArray(r.layers)?r.layers:[],a),t=yield e;if(yield i,"group"===t.type)return t.layers.addMany(y),t})).apply(this,arguments)}function k(e,r,a){return f.apply(this,arguments)}function f(){return(f=(0,o.Z)(function*(e,r,a){const y=L.T.FeatureLayer,i=yield y(),t=r.featureCollection,n=t.showLegend,g=t.layers.map((u,s)=>{const c=new i;c.read(u,a);const h={...a,ignoreDefaults:!0};return c.read({id:`${e.id}-sublayer-${s}`,visibility:r.visibleLayers?.includes(s)??!0},h),null!=n&&c.read({showLegend:n},h),c});e.layers.addMany(g)})).apply(this,arguments)}}}]);