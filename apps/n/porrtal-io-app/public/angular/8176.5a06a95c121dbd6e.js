"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[8176],{78176:(W,v,t)=>{t.r(v),t.d(v,{FeatureCollectionSnappingSource:()=>r});var c=t(15861),i=t(17626),M=t(14517),l=t(62208),u=t(10699),g=t(32917),s=t(77712),A=(t(85931),t(90912),t(76898)),h=t(60507),d=t(44725),C=t(4257),D=t(17936),I=t(1520),P=t(83010);let r=class extends M.Z{constructor(e){super(e),this.view=null,this._layerView3D=null}get availability(){return 1}get updating(){return this.layerSource.updating}get _snappingElevationAligner(){const{view:e}=this,{layer:n}=this.layerSource,o=(0,l.pC)(e)&&"3d"===e.type;if(!o||"subtype-group"===n.type)return(0,D.p)();const a=function(){var _=(0,c.Z)(function*(p,y){return(yield(0,u.Hl)(e.whenLayerView(n),y)).elevationAlignPointsInFeatures(p,y)});return function(y,S){return _.apply(this,arguments)}}();return(0,D.p)(o,{elevationInfo:n.elevationInfo,alignPointsInFeatures:a,spatialReference:e.spatialReference})}get _snappingElevationFilter(){const{view:e}=this,n=(0,l.pC)(e)&&"3d"===e.type&&"subtype-group"!==this.layerSource.layer.type;return(0,I.c)(n)}get _symbologySnappingFetcher(){const{view:e}=this,{layer:n}=this.layerSource;return(0,l.pC)(e)&&"3d"===e.type&&"subtype-group"!==n.type?(0,P.k)(this._symbologySnappingSupported,function(){var o=(0,c.Z)(function*(a,_){const p=yield e.whenLayerView(n);return(0,u.k_)(_),p.queryForSymbologySnapping({candidates:a,spatialReference:e.spatialReference},_)});return function(a,_){return o.apply(this,arguments)}}()):(0,P.k)()}get _symbologySnappingSupported(){return(0,l.pC)(this._layerView3D)&&this._layerView3D.symbologySnappingSupported}initialize(){const{view:e}=this,{layer:n}=this.layerSource;(0,l.pC)(e)&&"3d"===e.type&&"subtype-group"!==n.type&&(e.whenLayerView(n).then(o=>this._layerView3D=o),this.addHandles([e.elevationProvider.on("elevation-change",({context:o})=>{const{elevationInfo:a}=n;(0,h.W_)(o,a)&&this._snappingElevationAligner.notifyElevationSourceChange()}),(0,g.YP)(()=>n.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),g.nn),(0,g.YP)(()=>(0,l.pC)(this._layerView3D)?this._layerView3D.processor?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),g.nn)]))}refresh(){}fetchCandidates(e,n){var o=this;return(0,c.Z)(function*(){const{layer:a}=o.layerSource,{coordinateHelper:_,elevationInfo:p}=e,y=a.source;if(!y.querySnapping)return[];const S=(0,d.ML)(a),O=(0,d.rh)(e,S),U=yield y.querySnapping(O,{signal:n});(0,u.k_)(n);const E=yield o._snappingElevationAligner.alignCandidates(U.candidates,n);(0,u.k_)(n);const f=yield o._symbologySnappingFetcher.fetch(E,n);(0,u.k_)(n);const m=0===f.length?E:[...E,...f],L=o._snappingElevationFilter.filter(O,m),R=_.hasZ()?h.jG:p,j=o._getGroundElevation;return L.map(T=>(0,C.X)(T,_,R,j))})()}get _getGroundElevation(){return(0,C.g)(this.view)}};(0,i._)([(0,s.Cb)({constructOnly:!0})],r.prototype,"layerSource",void 0),(0,i._)([(0,s.Cb)({constructOnly:!0})],r.prototype,"view",void 0),(0,i._)([(0,s.Cb)()],r.prototype,"_snappingElevationAligner",null),(0,i._)([(0,s.Cb)()],r.prototype,"_snappingElevationFilter",null),(0,i._)([(0,s.Cb)()],r.prototype,"_symbologySnappingFetcher",null),(0,i._)([(0,s.Cb)()],r.prototype,"_layerView3D",void 0),(0,i._)([(0,s.Cb)()],r.prototype,"_symbologySnappingSupported",null),(0,i._)([(0,s.Cb)()],r.prototype,"_getGroundElevation",null),r=(0,i._)([(0,A.j)("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],r)}}]);