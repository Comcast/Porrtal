"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[3482],{3482:(Q,j,v)=>{v.d(j,{Z:()=>N});var h=v(15861),A=v(62074),Z=v(49086),D=v(91510),F=v(77132),T=v(87215);class N extends Z.Z{constructor(g){super(g),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=g.relationString,this._parent=g.parentfeatureset,this._maxProcessing=40,this._relation=g.relation,this._relationGeom=g.relationGeom}_getSet(g){var E=this;return(0,h.Z)(function*(){if(null===E._wset){yield E._ensureLoaded();const C=yield E._parent._getFilteredSet("esriSpatialRelRelation"!==E._relation?E._relation:E._relation+":"+E._relationString,E._relationGeom,null,null,g);return E._checkCancelled(g),E._wset=new D.Z(C._candidates.slice(0),C._known.slice(0),C._ordered,E._clonePageDefinition(C.pagesDefinition)),E._wset}return E._wset})()}_isInFeatureSet(g){let E=this._parent._isInFeatureSet(g);return E===F.dj.NotInFeatureSet?E:(E=this._idstates[g],void 0===E?F.dj.Unknown:E)}_getFeature(g,E,C){return this._parent._getFeature(g,E,C)}_getFeatures(g,E,C,O){return this._parent._getFeatures(g,E,C,O)}_featureFromCache(g){return this._parent._featureFromCache(g)}executeSpatialRelationTest(g){var E=this;return(0,h.Z)(function*(){if(null===g.geometry)return!1;switch(E._relation){case"esriSpatialRelEnvelopeIntersects":{const C=(0,F.SV)(E._relationGeom),O=(0,F.SV)(g.geometry);return(0,T.kK)(C,O)}case"esriSpatialRelIntersects":return(0,T.kK)(E._relationGeom,g.geometry);case"esriSpatialRelContains":return(0,T.r3)(E._relationGeom,g.geometry);case"esriSpatialRelOverlaps":return(0,T.Nm)(E._relationGeom,g.geometry);case"esriSpatialRelWithin":return(0,T.uh)(E._relationGeom,g.geometry);case"esriSpatialRelTouches":return(0,T.W4)(E._relationGeom,g.geometry);case"esriSpatialRelCrosses":return(0,T.jU)(E._relationGeom,g.geometry);case"esriSpatialRelRelation":return(0,T.LV)(E._relationGeom,g.geometry,E._relationString)}})()}_fetchAndRefineFeatures(g,E,C){var O=this;return(0,h.Z)(function*(){const d=new D.Z([],g,!1,null),m=Math.min(E,g.length);yield O._parent._getFeatures(d,-1,m,C),O._checkCancelled(C);const e=[];for(let r=0;r<m;r++){const i=O._parent._featureFromCache(g[r]);e.push(yield O.executeSpatialRelationTest(i))}for(let r=0;r<E;r++)O._idstates[g[r]]=!0===e[r]?F.dj.InFeatureSet:F.dj.NotInFeatureSet;return"success"})()}_getFilteredSet(g,E,C,O,d){var m=this;return(0,h.Z)(function*(){yield m._ensureLoaded();const e=yield m._parent._getFilteredSet("esriSpatialRelRelation"!==m._relation?m._relation:m._relation+":"+m._relationString,m._relationGeom,C,O,d);let r;return m._checkCancelled(d),r=null!==E?new D.Z(e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,m._clonePageDefinition(e.pagesDefinition)):new D.Z(e._candidates.slice(0),e._known.slice(0),e._ordered,m._clonePageDefinition(e.pagesDefinition)),r})()}_stat(g,E,C,O,d,m,e){var r=this;return(0,h.Z)(function*(){if(""!==C)return{calculated:!1};const i=yield r._parent._stat(g,E,"esriSpatialRelRelation"!==r._relation?r._relation:r._relation+":"+r._relationString,r._relationGeom,d,m,e);return!1===i.calculated?null===d&&""===C&&null===O?r._manualStat(g,E,m,e):{calculated:!1}:i})()}_canDoAggregates(g,E,C,O,d){var m=this;return(0,h.Z)(function*(){return""===C&&null===O&&null!==m._parent&&m._parent._canDoAggregates(g,E,"esriSpatialRelRelation"!==m._relation?m._relation:m._relation+":"+m._relationString,m._relationGeom,d)})()}_getAggregatePagesDataSourceDefinition(g,E,C,O,d,m,e){var r=this;return(0,h.Z)(function*(){if(null===r._parent)throw new Error("Should never be called");return r._parent._getAggregatePagesDataSourceDefinition(g,E,"esriSpatialRelRelation"!==r._relation?r._relation:r._relation+":"+r._relationString,r._relationGeom,d,m,e)})()}static registerAction(){Z.Z._featuresetFunctions.intersects=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:g})},Z.Z._featuresetFunctions.envelopeIntersects=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:g})},Z.Z._featuresetFunctions.contains=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:g})},Z.Z._featuresetFunctions.overlaps=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:g})},Z.Z._featuresetFunctions.within=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:g})},Z.Z._featuresetFunctions.touches=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:g})},Z.Z._featuresetFunctions.crosses=function(g){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:g})},Z.Z._featuresetFunctions.relate=function(g,E){return null==g?new A.Z({parentfeatureset:this}):new N({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:g,relationString:E})}}}},62074:(Q,j,v)=>{v.d(j,{Z:()=>F});var h=v(15861),A=v(49086),Z=v(91510),D=v(77132);class F extends A.Z{constructor(N){super(N),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new Z.Z([],[],!1,null),this._parent=N.parentfeatureset,this._databaseType=D.Bj.Standardised}_getSet(){var N=this;return(0,h.Z)(function*(){return N._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return D.dj.NotInFeatureSet}_getFeature(){return(0,h.Z)(function*(){throw new Error("No Feature Found in EmptySet")})()}queryAttachments(){return(0,h.Z)(function*(){return[]})()}_getFeatures(){return(0,h.Z)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,h.Z)(function*(){throw new Error("Fetch and Refine should not be called in this featureset")})()}_getFilteredSet(){return(0,h.Z)(function*(){return new Z.Z([],[],!1,null)})()}_stat(N,y,g,E,C,O,d){return this._manualStat(N,y,O,d)}_canDoAggregates(){return(0,h.Z)(function*(){return!1})()}}},49086:(Q,j,v)=>{v.d(j,{Z:()=>O});var h=v(15861),A=v(53791);class Z{constructor(m,e){this._lastId=-1,this._progress=e,this._parent=m}reset(){this._lastId=-1}nextBatch(m){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(i=>this.nextBatch(m),i=>this.nextBatch(m));const e={returnpromise:null,hasset:!1},r=[];return e.returnpromise=new Promise((i,a)=>{this._parent._getSet(this._progress).then(l=>{let o=l._known.length-1;if("GETPAGES"===l._known[l._known.length-1]&&(o-=1),this._lastId+m>o&&l._known.length>0&&"GETPAGES"===l._known[l._known.length-1])this._parent._expandPagedSet(l,this._parent._maxQueryRate(),0,0,this._progress).then(s=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(m).then(i,a)},s=>{e.hasset=!0,this._parent._mainSetInUse=null,a(s)});else{if(o>=this._lastId+m||0===l._candidates.length){for(let s=0;s<m;s++){const n=s+this._lastId+1;if(n>=l._known.length)break;r[s]=l._known[n]}return this._lastId+=r.length,0===r.length&&(e.hasset=!0,this._parent._mainSetInUse=null,i([])),void this._parent._getFeatureBatch(r,this._progress).then(s=>{e.hasset=!0,this._parent._mainSetInUse=null,i(s)},s=>{e.hasset=!0,this._parent._mainSetInUse=null,a(s)})}this._parent._refineSetBlock(l,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(m).then(i,a)},s=>{e.hasset=!0,this._parent._mainSetInUse=null,a(s)})}},l=>{e.hasset=!0,this._parent._mainSetInUse=null,a(l)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(e=>this.next(),e=>this.next());const m={returnpromise:null,hasset:!1};return m.returnpromise=new Promise((e,r)=>{this._parent._getSet(this._progress).then(i=>{this._lastId<i._known.length-1?"GETPAGES"===i._known[this._lastId+1]?this._parent._expandPagedSet(i,this._parent._maxQueryRate(),0,0,this._progress).then(a=>(m.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(e,r):(this._lastId+=1,this._parent._getFeature(i,i._known[this._lastId],this._progress).then(a=>{m.hasset=!0,this._parent._mainSetInUse=null,e(a)},a=>{m.hasset=!0,this._parent._mainSetInUse=null,r(a)})):i._candidates.length>0?this._parent._refineSetBlock(i,this._parent._maxProcessingRate(),this._progress).then(()=>{m.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,r)},a=>{m.hasset=!0,this._parent._mainSetInUse=null,r(a)}):(m.hasset=!0,this._parent._mainSetInUse=null,e(null))},i=>{m.hasset=!0,this._parent._mainSetInUse=null,r(i)})}),!1===m.hasset&&(this._parent._mainSetInUse=m.returnpromise,m.hasset=!0),m.returnpromise}count(){var m=this;return(0,h.Z)(function*(){if(-1!==m._parent._totalCount)return m._parent._totalCount;const e=yield m._parent._getSet(m._progress),r=yield m._refineAllSets(e);return m._parent._totalCount=r._known.length,m._parent._totalCount})()}_refineAllSets(m){var e=this;return(0,h.Z)(function*(){if(m._known.length>0&&"GETPAGES"===m._known[m._known.length-1])return yield e._parent._expandPagedSet(m,e._parent._maxQueryRate(),0,1,e._progress),e._refineAllSets(m);if(m._candidates.length>0){if("GETPAGES"===m._known[m._candidates.length-1])return yield e._parent._expandPagedSet(m,e._parent._maxQueryRate(),0,2,e._progress),e._refineAllSets(m);const r=yield e._parent._refineSetBlock(m,e._parent._maxProcessingRate(),e._progress);return r._candidates.length>0?e._refineAllSets(r):r}return m})()}}var D=v(91510),F=v(77132),T=v(45333),N=v(10699),y=v(10410),g=v(87215),E=v(65234),C=v(60466);let O=(()=>{class d{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=F.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,e&&e.lrucache&&(this.recentlyUsedQueries=e.lrucache),e&&e.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,r){return void 0===r?this[e]:(void 0!==this[e]&&(this[e]=r),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,h.Z)(function*(){return!0===e._parent.loaded?(e._initialiseFeatureSet(),e):(yield e._parent.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new E.Z({wkid:4326}),this.geometryType=F.Qk.point)}getField(e,r){let i;return(r=r||this.fields)&&(e=e.toLowerCase(),r.some(a=>(a&&a.name.toLowerCase()===e&&(i=a),!!i))),i}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=new C.Z(this.fields)),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!==e&&e.aborted)throw new Error("Operation has been cancelled.")}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,r,i,a,l){var o=this;return(0,h.Z)(function*(){return null!==o._parent&&o._parent._canDoAggregates(e,r,i,a,l)})()}_getAggregatePagesDataSourceDefinition(e,r,i,a,l,o,s){var n=this;return(0,h.Z)(function*(){if(null===n._parent)throw new Error("Should never be called");return n._parent._getAggregatePagesDataSourceDefinition(e,r,i,a,l,o,s)})()}_getAgregagtePhysicalPage(e,r,i){var a=this;return(0,h.Z)(function*(){if(null===a._parent)throw new Error("Should never be called");return a._parent._getAgregagtePhysicalPage(e,r,i)})()}databaseType(){var e=this;return(0,h.Z)(function*(){if(e._databaseType===F.Bj.NotEvaluated){if(null!==A.Z.applicationCache){const r=A.Z.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==r)return r}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==A.Z.applicationCache&&A.Z.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(r){throw null!==A.Z.applicationCache&&A.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),r}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,h.Z)(function*(){const r=[{thetype:F.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:F.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:F.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const i of r)if(!0===(yield e._runDatabaseProbe(i.testwhere)))return i.thetype;return F.Bj.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var r=this;return(0,h.Z)(function*(){if(null!==r._parent)return r._parent._runDatabaseProbe(e);throw new Error("Not Implemented")})()}isTable(){return this._parent.isTable()}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return F.dj.Unknown}_getSet(e){throw new Error("Not implemented in abstract class")}_getFeature(e,r,i){var a=this;return(0,h.Z)(function*(){if(a._checkCancelled(i),void 0!==a._featureFromCache(r)||(yield a._getFeatures(e,r,a._maxProcessingRate(),i),a._checkCancelled(i),void 0!==a._featureFromCache(r)))return a._featureFromCache(r);throw new Error("Feature Not Found")})()}_getFeatureBatch(e,r){var i=this;return(0,h.Z)(function*(){i._checkCancelled(r);const a=new D.Z([],e,!1,null),l=[];yield i._getFeatures(a,-1,e.length,r),i._checkCancelled(r);for(const o of e)void 0!==i._featureFromCache(o)&&l.push(i._featureFromCache(o));return l})()}_getFeatures(e,r,i,a){return(0,h.Z)(function*(){return"success"})()}_getFilteredSet(e,r,i,a,l){throw new Error("Not implemented in abstract class")}_refineSetBlock(e,r,i){var a=this;return(0,h.Z)(function*(){if(!0===a._checkIfNeedToExpandCandidatePage(e,a._maxQueryRate()))return yield a._expandPagedSet(e,a._maxQueryRate(),0,0,i),a._refineSetBlock(e,r,i);a._checkCancelled(i);const l=e._candidates.length;a._refineKnowns(e,r);let o=l-e._candidates.length;if(0===e._candidates.length||o>=r)return e;if(yield a._refineIfParentKnown(e,r-o,i),a._checkCancelled(i),a._refineKnowns(e,r-o),o=l-e._candidates.length,o<r&&e._candidates.length>0){const s=r-o,n=a._prepareFetchAndRefineSet(e._candidates);return yield a._fetchAndRefineFeatures(n,n.length>s?s:e._candidates.length,i),a._checkCancelled(i),a._refineKnowns(e,r-o),e}return e})()}_fetchAndRefineFeatures(e,r,i){return null}_prepareFetchAndRefineSet(e){const r=[];for(let i=0;i<e.length;i++)this._isPhysicalFeature(e[i])&&r.push(e[i]);return r}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,r){let i=0,a=null;const l=[];r=this._maxQueryRate();for(let o=0;o<e._candidates.length&&"GETPAGES"!==e._candidates[o];o++){let s=!1;const n=this._candidateIdTransform(e._candidates[o]);n!==e._candidates[o]&&(s=!0);const c=this._isInFeatureSet(n);if(c===F.dj.InFeatureSet)!0===s?e._known.includes(n)||(e._known.push(n),i+=1):(e._known.push(e._candidates[o]),i+=1),null===a?a={start:o,end:o}:a.end===o-1?a.end=o:(l.push(a),a={start:o,end:o});else if(c===F.dj.NotInFeatureSet)null===a?a={start:o,end:o}:a.end===o-1?a.end=o:(l.push(a),a={start:o,end:o}),i+=1;else if(c===F.dj.Unknown&&(i+=1,!0===e._ordered))break;if(i>=r)break}null!==a&&l.push(a);for(let o=l.length-1;o>=0;o--)e._candidates.splice(l[o].start,l[o].end-l[o].start+1)}_refineIfParentKnown(e,r,i){const a=new D.Z([],[],e._ordered,null);return a._candidates=e._candidates.slice(0),this._parent._refineSetBlock(a,r,i)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,r){if(null===e.pagesDefinition)return!1;let i=0;for(let a=e._lastFetchedIndex;a<e._known.length;a++){if("GETPAGES"===e._known[a])return!0;if(void 0===this._featureCache[e._known[a]]&&(i+=1,i>=r))break}return!1}_checkIfNeedToExpandCandidatePage(e,r){if(null===e.pagesDefinition)return!1;let i=0;for(let a=0;a<e._candidates.length;a++){if("GETPAGES"===e._candidates[a])return!0;if(i+=1,i>=r)break}return!1}_expandPagedSet(e,r,i,a,l){var o=this;return(0,h.Z)(function*(){if(null===o._parent)throw new Error("Parent Paging not implemented");return o._parent._expandPagedSet(e,r,i,a,l)})()}_expandPagedSetFeatureSet(e,r,i,a,l){var o=this;return(0,h.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(a=1),0===a&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(a=2),0===a)return"finished";const s=yield o._getPage(e,a,l);return i+s<r?o._expandPagedSet(e,r,i+s,0,l):"success"})()}_getPage(e,r,i){var a=this;return(0,h.Z)(function*(){const l=1===r?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){l.length=l.length-1;let o=0;for(let n=0;n<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+n>=e.pagesDefinition.internal.set.length);n++)l[l.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+n],o++;e.pagesDefinition.resultOffset+=o;let s=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(s=!0),!1===s&&l.push("GETPAGES"),o}return yield a._getPhysicalPage(e,r,i),a._getPage(e,r,i)})()}_getPhysicalPage(e,r,i){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,r,i,a){var l=this;return(0,h.Z)(function*(){yield l._ensureLoaded();let o=yield l._stat(e,r,"",null,null,i,a);return!1===o.calculated&&(o=yield l._manualStat(e,r,i,a)),o.result})()}_manualStat(e,r,i,a){var l=this;return(0,h.Z)(function*(){let o=null;switch(e.toLowerCase()){case"count":return o=yield(0,T.QX)(l,a),{calculated:!0,result:o};case"distinct":return o=yield(0,T.EB)(l,r,i),{calculated:!0,result:o};case"avg":case"mean":return o=yield(0,T.J6)(l,r,a),{calculated:!0,result:o};case"stdev":return o=yield(0,T.m)(l,r,a),{calculated:!0,result:o};case"variance":return o=yield(0,T.CA)(l,r,a),{calculated:!0,result:o};case"sum":return o=yield(0,T.Sm)(l,r,a),{calculated:!0,result:o};case"min":return o=yield(0,T.VV)(l,r,a),{calculated:!0,result:o};case"max":return o=yield(0,T.Fp)(l,r,a),{calculated:!0,result:o};default:return{calculated:!0,result:0}}})()}_stat(e,r,i,a,l,o,s){var n=this;return(0,h.Z)(function*(){const c=yield n._parent._stat(e,r,i,a,l,o,s);return!1===c.calculated?null===l&&""===i&&null===a?n._manualStat(e,r,o,s):{calculated:!1}:c})()}_unionAllGeomSelf(e){const r=this.iterator(this._defaultTracker(e)),i=[];return new Promise((a,l)=>{this._unionShapeInBatches(i,r,a,l)})}_unionAllGeom(e){return new Promise((r,i)=>{const a=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],a,r,i)})}_unionShapeInBatches(e,r,i,a){r.next().then(l=>{try{null!==l&&null!==l.geometry&&e.push(l.geometry),e.length>30||null===l&&e.length>1?(0,g.G0)(e).then(o=>{try{null===l?i(o):this._unionShapeInBatches(e=[o],r,i,a)}catch(s){a(s)}},a):null===l?i(1===e.length?e[0]:null):this._unionShapeInBatches(e,r,i,a)}catch(o){a(o)}},a)}iterator(e){return new Z(this,e)}intersection(e,r=!1){return d._featuresetFunctions.intersection.bind(this)(e,r)}difference(e,r=!1,i=!0){return d._featuresetFunctions.difference.bind(this)(e,r,i)}symmetricDifference(e,r=!1,i=!0){return d._featuresetFunctions.symmetricDifference.bind(this)(e,r,i)}morphShape(e,r,i="unknown",a=null){return d._featuresetFunctions.morphShape.bind(this)(e,r,i,a)}morphShapeAndAttributes(e,r,i="unknown"){return d._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,r,i)}union(e,r=!1){return d._featuresetFunctions.union.bind(this)(e,r)}intersects(e){return d._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return d._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return d._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return d._featuresetFunctions.overlaps.bind(this)(e)}relate(e,r){return d._featuresetFunctions.relate.bind(this)(e,r)}within(e){return d._featuresetFunctions.within.bind(this)(e)}touches(e){return d._featuresetFunctions.touches.bind(this)(e)}top(e){return d._featuresetFunctions.top.bind(this)(e)}crosses(e){return d._featuresetFunctions.crosses.bind(this)(e)}buffer(e,r,i,a=!0){return d._featuresetFunctions.buffer.bind(this)(e,r,i,a)}filter(e,r=null){return d._featuresetFunctions.filter.bind(this)(e,r)}orderBy(e){return d._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,r){return d._featuresetFunctions.dissolve.bind(this)(e,r)}groupby(e,r){return d._featuresetFunctions.groupby.bind(this)(e,r)}reduce(e,r=null,i){return new Promise((a,l)=>{this._reduceImpl(this.iterator(this._defaultTracker(i)),e,r,0,a,l,0)})}_reduceImpl(e,r,i,a,l,o,s){try{if(++s>1e3)return void setTimeout(()=>{this._reduceImpl(e,r,i,a,l,o,s=0)});e.next().then(n=>{try{if(null===n)l(i);else{const c=r(i,n,a,this);(0,N.y8)(c)?c.then(p=>{this._reduceImpl(e,r,p,a+1,l,o,s)},o):this._reduceImpl(e,r,c,a+1,l,o,s)}}catch(c){o(c)}},o)}catch(n){o(n)}}removeField(e){return d._featuresetFunctions.removeField.bind(this)(e)}addField(e,r,i=null){return d._featuresetFunctions.addField.bind(this)(e,r,i)}sumArea(e,r=!1,i){const a=(0,F.EI)(e);return this.reduce((l,o)=>null===o.geometry?0:r?(0,g.Y4)(o.geometry,a).then(s=>l+s):(0,g.CJ)(o.geometry,a).then(s=>l+s),0,i)}sumLength(e,r=!1,i){const a=(0,F.Lz)(e);return this.reduce((l,o)=>null===o.geometry?0:r?(0,g.kQ)(o.geometry,a).then(s=>l+s):(0,g.sz)(o.geometry,a).then(s=>l+s),0,i)}_substituteVars(e,r){if(null!==r){const i={};for(const a in r)i[a.toLowerCase()]=r[a];e.parameters=i}}distinct(e,r=1e3,i=null,a){var l=this;return(0,h.Z)(function*(){yield l.load();const o=y.WhereClause.create(e,l.getFieldsIndex());return l._substituteVars(o,i),l.calculateStatistic("distinct",o,r,l._defaultTracker(a))})()}min(e,r=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=y.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,r),a.calculateStatistic("min",l,-1,a._defaultTracker(i))})()}max(e,r=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=y.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,r),a.calculateStatistic("max",l,-1,a._defaultTracker(i))})()}avg(e,r=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=y.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,r),a.calculateStatistic("avg",l,-1,a._defaultTracker(i))})()}sum(e,r=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=y.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,r),a.calculateStatistic("sum",l,-1,a._defaultTracker(i))})()}stdev(e,r=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=y.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,r),a.calculateStatistic("stdev",l,-1,a._defaultTracker(i))})()}variance(e,r=null,i){var a=this;return(0,h.Z)(function*(){yield a.load();const l=y.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(l,r),a.calculateStatistic("variance",l,-1,a._defaultTracker(i))})()}count(e){var r=this;return(0,h.Z)(function*(){return yield r.load(),r.calculateStatistic("count",y.WhereClause.create("1",r.getFieldsIndex()),-1,r._defaultTracker(e))})()}_defaultTracker(e){return e||{aborted:!1}}forEach(e,r){return new Promise((i,a)=>{this._forEachImpl(this.iterator(this._defaultTracker(r)),e,this,i,a,0)})}_forEachImpl(e,r,i,a,l,o){try{if(++o>1e3)return void setTimeout(()=>{this._forEachImpl(e,r,i,a,l,o=0)},0);e.next().then(s=>{try{if(null===s)a(i);else{const n=r(s);null==n?this._forEachImpl(e,r,i,a,l,o):(0,N.y8)(n)?n.then(()=>{try{this._forEachImpl(e,r,i,a,l,o)}catch(c){l(c)}},l):this._forEachImpl(e,r,i,a,l,o)}}catch(n){l(n)}},l)}catch(s){l(s)}}convertToJSON(e){const r={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let i=0;i<this.fields.length;i++)r.layerDefinition.fields.push((0,F.Sh)(this.fields[i]));return this.reduce((i,a)=>{const l={geometry:a.geometry&&a.geometry.toJSON(),attributes:{}};for(const o in a.attributes)l.attributes[o]=a.attributes[o];return r.featureSet.features.push(l),1},0,e).then(()=>r)}castToText(){return"object, FeatureSet"}queryAttachments(e,r,i,a,l){return this._parent.queryAttachments(e,r,i,a,l)}serviceUrl(){return this._parent.serviceUrl()}subtypes(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const r of this.fields)e.push((0,F.Sh)(r));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===F.q2[this.geometryType]?"":F.q2[this.geometryType],fields:e}}convertToText(e,r){var i=this;return(0,h.Z)(function*(){if("schema"===e)return yield i._ensureLoaded(),JSON.stringify(i.schema());if("featureset"===e){yield i._ensureLoaded();const a=[];yield i.reduce((o,s)=>{const n={geometry:s.geometry?s.geometry.toJSON():null,attributes:s.attributes};return null!==n.geometry&&n.geometry.spatialReference&&delete n.geometry.spatialReference,a.push(n),1},0,r);const l=i.schema();return l.features=a,l.spatialReference=i.spatialReference.toJSON(),JSON.stringify(l)}return i.castToText()})()}getFeatureByObjectId(e,r){return this._parent.getFeatureByObjectId(e,r)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,r=null){var i=this;return(0,h.Z)(function*(){if("keeptype"===r?.featureset)return i;if("schema"===r?.featureset)return yield i._ensureLoaded(),JSON.parse(JSON.stringify(i.schema()));if("none"===r?.featureset)return null;yield i._ensureLoaded();const a=[];yield i.reduce((o,s)=>{const n={geometry:s.geometry?!0===r?.keepGeometryType?s.geometry:s.geometry.toJSON():null,attributes:s.attributes};return null!==n.geometry&&n.geometry.spatialReference&&!0!==r?.keepGeometryType&&delete n.geometry.spatialReference,a.push(n),1},0,e);const l=i.schema();return l.features=a,l.spatialReference=!0===r?.keepGeometryType?i.spatialReference:i.spatialReference.toJSON(),l})()}}return d._featuresetFunctions={},d})()},91510:(Q,j,v)=>{v.d(j,{Z:()=>h});class h{constructor(Z,D,F,T){this._candidates=null,this._known=null,this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=Z,this._known=D,this._ordered=F,this.pagesDefinition=T}}},53791:(Q,j,v)=>{v.d(j,{Z:()=>h});let h=(()=>{class A{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(D){void 0===this._databaseTypeMetaData[D]&&delete this._databaseTypeMetaData[D]}getDatabaseType(D){return"MUSTBESET"===D||void 0===this._databaseTypeMetaData[D]?null:this._databaseTypeMetaData[D]}setDatabaseType(D,F){this._databaseTypeMetaData[D]=F}getLayerInfo(D){return void 0===this._layerInfo[D]?null:this._layerInfo[D]}setLayerInfo(D,F){this._layerInfo[D]=F}clearLayerInfo(D){void 0!==this._layerInfo[D]&&delete this._layerInfo[D]}}return A.applicationCache=null,A})()},83947:(Q,j,v)=>{v.d(j,{$e:()=>N,DT:()=>O,TE:()=>o,XF:()=>F,bB:()=>T,fz:()=>g,hq:()=>r,oX:()=>E,vR:()=>C,y5:()=>i,zR:()=>D});var h=v(77132),A=v(10410),Z=v(27122);function D(s,n){return y(s.parseTree,n,s.parameters)}function F(s,n,c){return y(s,n,c)}function T(s,n,c,p){return A.WhereClause.create(y(s.parseTree,h.Bj.Standardised,s.parameters,n,c),p)}function N(s,n,c="AND"){return A.WhereClause.create("(("+D(s,h.Bj.Standardised)+")"+c+"("+D(n,h.Bj.Standardised)+"))",s.fieldsIndex)}function y(s,n,c,p=null,S=null){let b,R,U,W;switch(s.type){case"interval":return o(y(s.value,n,c,p,S),s.qualifier,s.op);case"case-expression":{let f=" CASE ";"simple"===s.format&&(f+=y(s.operand,n,c,p,S));for(let I=0;I<s.clauses.length;I++)f+=" WHEN "+y(s.clauses[I].operand,n,c,p,S)+" THEN "+y(s.clauses[I].value,n,c,p,S);return null!==s.else&&(f+=" ELSE "+y(s.else,n,c,p,S)),f+=" END ",f}case"parameter":{const f=c[s.value.toLowerCase()];if("string"==typeof f)return"'"+c[s.value.toLowerCase()].toString().replace(/'/g,"''")+"'";if(f instanceof Date)return E(f,n);if(f instanceof Array){const I=[];for(let w=0;w<f.length;w++)"string"==typeof f[w]?I.push("'"+f[w].toString().replace(/'/g,"''")+"'"):f[w]instanceof Date?I.push(E(f[w],n)):I.push(f[w].toString());return I}return f.toString()}case"expression-list":R=[];for(const f of s.value)R.push(y(f,n,c,p,S));return R;case"unary-expression":return" ( NOT "+y(s.expr,n,c,p,S)+" ) ";case"binary-expression":switch(s.operator){case"AND":return" ("+y(s.left,n,c,p,S)+" AND "+y(s.right,n,c,p,S)+") ";case"OR":return" ("+y(s.left,n,c,p,S)+" OR "+y(s.right,n,c,p,S)+") ";case"IS":if("null"!==s.right.type)throw new Error("Unsupported RHS for IS");return" ("+y(s.left,n,c,p,S)+" IS NULL )";case"ISNOT":if("null"!==s.right.type)throw new Error("Unsupported RHS for IS");return" ("+y(s.left,n,c,p,S)+" IS NOT NULL )";case"IN":return b=[],"expression-list"===s.right.type?(b=y(s.right,n,c,p,S)," ("+y(s.left,n,c,p,S)+" IN ("+b.join(",")+")) "):(W=y(s.right,n,c,p,S),W instanceof Array?" ("+y(s.left,n,c,p,S)+" IN ("+W.join(",")+")) ":" ("+y(s.left,n,c,p,S)+" IN ("+W+")) ");case"NOT IN":return b=[],"expression-list"===s.right.type?(b=y(s.right,n,c,p,S)," ("+y(s.left,n,c,p,S)+" NOT IN ("+b.join(",")+")) "):(W=y(s.right,n,c,p,S),W instanceof Array?" ("+y(s.left,n,c,p,S)+" NOT IN ("+W.join(",")+")) ":" ("+y(s.left,n,c,p,S)+" NOT IN ("+W+")) ");case"BETWEEN":return U=y(s.right,n,c,p,S)," ("+y(s.left,n,c,p,S)+" BETWEEN "+U[0]+" AND "+U[1]+" ) ";case"NOTBETWEEN":return U=y(s.right,n,c,p,S)," ("+y(s.left,n,c,p,S)+" NOT BETWEEN "+U[0]+" AND "+U[1]+" ) ";case"LIKE":return""!==s.escape?" ("+y(s.left,n,c,p,S)+" LIKE "+y(s.right,n,c,p,S)+" ESCAPE '"+s.escape+"') ":" ("+y(s.left,n,c,p,S)+" LIKE "+y(s.right,n,c,p,S)+") ";case"NOT LIKE":return""!==s.escape?" ("+y(s.left,n,c,p,S)+" NOT LIKE "+y(s.right,n,c,p,S)+" ESCAPE '"+s.escape+"') ":" ("+y(s.left,n,c,p,S)+" NOT LIKE "+y(s.right,n,c,p,S)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+y(s.left,n,c,p,S)+" "+s.operator+" "+y(s.right,n,c,p,S)+") "}throw new Error("Not Supported Operator "+s.operator);case"null":return"null";case"boolean":return!0===s.value?"1":"0";case"string":return"'"+s.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return E(s.value,n);case"number":return s.value.toString();case"current-time":return C("date"===s.mode,n);case"column-reference":return p&&p.toLowerCase()===s.column.toLowerCase()?"("+S+")":s.column;case"function":{const f=y(s.args,n,c,p,S);return g(s.name,f,n)}}throw new Error("Unsupported sql syntax "+s.type)}function g(s,n,c){switch(s.toLowerCase().trim()){case"abs":if(1!==n.length)throw new Error("Invalid Parameter for call to ABS");return"abs("+n[0]+")";case"ceiling":case"ceil":if(1!==n.length)throw new Error("Invalid Parameter for call to CEILING");return"CEILING("+n[0]+")";case"floor":if(1!==n.length)throw new Error("Invalid Parameter for call to Floor");return"FLOOR("+n[0]+")";case"log":if(1!==n.length)throw new Error("Invalid Parameter for call to LOG");return"LOG("+n[0]+")";case"log10":if(1!==n.length)throw new Error("Invalid Parameter for call to LOG10");return"LOG10("+n[0]+")";case"power":if(2!==n.length)throw new Error("Invalid Parameter for call to POWER");return"POWER("+n[0]+","+n[1]+")";case"round":if(2===n.length)return"ROUND("+n[0]+","+n[1]+")";if(1===n.length)return"ROUND("+n[0]+")";throw new Error("Invalid Parameter for call to ROUND");case"truncate":if(n.length<1||n.length>2)throw new Error("Invalid Parameter for TRUNCATE function");return c===h.Bj.SqlServer?"ROUND("+n[0]+(1===n.length?"0":","+n[1])+",1)":"TRUNCATE("+n[0]+(1===n.length?")":","+n[1]+")");case"char_length":case"len":if(1!==n.length)throw new Error("Invalid Parameter for CHAR_LENGTH function");switch(c){case h.Bj.SqlServer:return"LEN("+n[0]+")";case h.Bj.Oracle:return"LENGTH("+n[0]+")";default:return"CHAR_LENGTH("+n[0]+")"}case"concat":if(n.length<1)throw new Error("Invalid Parameter for CONCAT function");{let p="CONCAT(";for(let S=0;S<n.length;S++)0!==S&&(p+=","),p+=n[S];return p+=")",p}case"lower":case"lcase":if(1!==n.length)throw new Error("Invalid Parameter for Lower function");return"LOWER("+n[0]+")";case"upper":case"ucase":if(1!==n.length)throw new Error("Invalid Parameter for Upper function");return"UPPER("+n[0]+")";case"substring":{let p="";switch(c){case h.Bj.Oracle:return p="SUBSTR("+n[0]+","+n[1],3===n.length&&(p+=","+n[2]),p+=")",p;case h.Bj.SqlServer:return p=3===n.length?"SUBSTRING("+n[0]+","+n[1]+","+n[2]+")":"SUBSTRING("+n[0]+",  "+n[1]+", LEN("+n[0]+") - "+n[1]+")",p;default:return p="SUBSTRING("+n[0]+" FROM "+n[1],3===n.length&&(p+=" FOR "+n[2]),p+=")",p}}case"extract":return"EXTRACT("+n[0].replace(/\'/g,"")+" FROM "+n[1]+")"}throw new Error("Function Not Recognised")}function E(s,n){const c=s instanceof Date?Z.ou.fromJSDate(s):Z.ou.fromSQL(s),p=0===c.hour&&0===c.minute&&0===c.second&&0===c.millisecond;switch(n){case h.Bj.FILEGDB:case h.Bj.Standardised:case h.Bj.StandardisedNoInterval:return p?`date '${c.toFormat("yyyy-LL-dd")}'`:`date '${c.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case h.Bj.Oracle:return p?`TO_DATE('${c.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${c.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case h.Bj.SqlServer:return`'${c.toFormat(p?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case h.Bj.PGDB:return`#${c.toFormat(p?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case h.Bj.Postgres:return`TIMESTAMP '${c.toFormat(p?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`date '${c.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function C(s,n){switch(n){case h.Bj.FILEGDB:case h.Bj.Standardised:case h.Bj.StandardisedNoInterval:case h.Bj.Oracle:return s?"CURRENT_DATE":"CURRENT_TIMESTAMP";case h.Bj.SqlServer:return s?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return s?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function O(s,n,c={}){const p={},S={},b={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",oid:"integer",long:"integer","small-integer":"integer",integer:"integer",single:"double",double:"double",date:"date",string:"string"};for(const R of n){const U=b[R.type];p[R.name.toLowerCase()]=void 0===U?"":U}for(const R in c){const U=b[c[R]];S[R.toLowerCase()]=void 0===U?"":U}switch(d(p,s.parseTree,s.parameters,S)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"string":return"string"}return""}function d(s,n,c,p){let S;switch(n.type){case"interval":return"integer";case"case-expression":{const b=[];if("simple"===n.format){for(let R=0;R<n.clauses.length;R++)b.push(d(s,n.clauses[R].value,c,p));null!==n.else&&b.push(d(s,n.else,c,p))}else{for(let R=0;R<n.clauses.length;R++)b.push(d(s,n.else,c,p));null!==n.else&&b.push(d(s,n.else,c,p))}return e(b)}case"parameter":{const b=p[n.value.toLowerCase()];if(void 0===b&&c){const R=c[n.value.toLowerCase()];if(null==R)return"";if("string"==typeof R||R instanceof String)return"string";if("boolean"==typeof R)return"boolean";if(R instanceof Date)return"date";if("number"==typeof R)return R%1==0?"integer":"double"}return void 0===b?"":b}case"expression-list":{const b=[];for(const R of n.value)b.push(d(s,R,c,p));return b}case"unary-expression":return"boolean";case"binary-expression":switch(n.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==n.right.type)throw new Error("Unsupported RHS for IS");return"boolean";case"*":case"-":case"+":case"/":return e([d(s,n.left,c,p),d(s,n.right,c,p)]);default:throw new Error("Not Supported Operator "+n.operator)}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===n.value?"":n.value%1==0?"integer":"double";case"date":case"timestamp":case"current-time":return"date";case"column-reference":{const b=s[n.column.toLowerCase()];return void 0===b?"":b}case"function":switch(n.name.toLowerCase()){case"position":case"extract":case"char_length":return"integer";case"round":return S=d(s,n.args,c,p),S instanceof Array?S.length>0?S[0]:"":S;case"sign":return S=d(s,n.args,c,p),S instanceof Array&&(S=e(S)),"integer"===S||"double"===S?S:"double";case"ceiling":case"floor":case"abs":{const b=d(s,n.args,c,p);return b instanceof Array?e(b):b}case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"power":case"truncate":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string"}return""}throw new Error("Unsupported sql syntax "+n.type)}const m={boolean:1,string:2,integer:3,double:4,date:5};function e(s){if(s){let n="";for(const c of s)""!==c&&(n=""===n||m[n]<m[c]?c:n);return n}return""}function r(s,n){return a(s.parseTree,n)}function i(s){return"column-reference"===s.parseTree.type}function a(s,n){if(null==s)return!1;switch(s.type){case"when-clause":return a(s.operand,n)||a(s.value,n);case"case-expression":for(const c of s.clauses)if(a(c,n))return!0;return!("simple"!==s.format||!a(s.operand,n))||!(null===s.else||!a(s.else,n));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"string":case"number":return!1;case"expression-list":for(const c of s.value)if(a(c,n))return!0;return!1;case"unary-expression":return a(s.expr,n);case"binary-expression":return a(s.left,n)||a(s.right,n);case"column-reference":return n.toLowerCase()===s.column.toLowerCase();case"function":return a(s.args,n)}return!1}function l(s){let n="";return n+=s.period.toUpperCase(),n}function o(s,n,c){let p="";return p="interval-period"===n.type?l(n):l(n.start)+" TO "+l(n.end),"INTERVAL "+c+" "+s+" "+p}},45333:(Q,j,v)=>{v.d(j,{CA:()=>a,EB:()=>U,Fp:()=>m,J6:()=>r,QX:()=>p,Sm:()=>n,VV:()=>O,g3:()=>E,m:()=>o,tj:()=>C});var h=v(15861),A=v(77132),Z=v(83947);function D(f){return f=+f,isFinite(f)?f-f%1||(f<0?-0:0===f?f:0):f}function F(f){let I=0;for(let w=0;w<f.length;w++)I+=f[w];return I/f.length}function T(f){const I=F(f);let w=0;for(let P=0;P<f.length;P++)w+=(I-f[P])**2;return w/f.length}function N(f){const I=F(f);let w=0;for(let P=0;P<f.length;P++)w+=(I-f[P])**2;return w/(f.length-1)}function y(f){let I=0;for(let w=0;w<f.length;w++)I+=f[w];return I}function E(f){switch(f.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function C(f,I,w=1e3){switch(f.toLowerCase()){case"distinct":return function g(f,I){const w=[],P={},G=[];for(let B=0;B<f.length;B++){if(null!=f[B]){const M=f[B];if((0,A.hj)(M)||(0,A.HD)(M))void 0===P[M]&&(w.push(M),P[M]=1);else{let H=!1;for(let k=0;k<G.length;k++)!0===(0,A.tt)(G[k],M)&&(H=!0);!1===H&&(G.push(M),w.push(M))}}if(w.length>=I&&-1!==I)return w}return w}(I,w);case"avg":case"mean":return F(I);case"min":return Math.min.apply(Math,I);case"sum":return y(I);case"max":return Math.max.apply(Math,I);case"stdev":case"stddev":return Math.sqrt(T(I));case"var":case"variance":return T(I);case"count":return I.length}return 0}function O(f,I,w){return d.apply(this,arguments)}function d(){return(d=(0,h.Z)(function*(f,I,w){const P=yield b(f,I,w,!0);return 0===P.length?null:Math.min.apply(Math,P)})).apply(this,arguments)}function m(f,I,w){return e.apply(this,arguments)}function e(){return(e=(0,h.Z)(function*(f,I,w){const P=yield b(f,I,w,!0);return 0===P.length?null:Math.max.apply(Math,P)})).apply(this,arguments)}function r(f,I,w){return i.apply(this,arguments)}function i(){return(i=(0,h.Z)(function*(f,I,w){let P="";!1===(0,Z.y5)(I)&&(P=(0,Z.DT)(I,f.fields,null));const G=yield b(f,I,w,!0);if(0===G.length)return null;const B=F(G);return null===B?B:"integer"===P?D(B):B})).apply(this,arguments)}function a(f,I,w){return l.apply(this,arguments)}function l(){return(l=(0,h.Z)(function*(f,I,w){const P=yield b(f,I,w,!0);return 0===P.length?null:N(P)})).apply(this,arguments)}function o(f,I,w){return s.apply(this,arguments)}function s(){return(s=(0,h.Z)(function*(f,I,w){const P=yield b(f,I,w,!0);return 0===P.length?null:Math.sqrt(N(P))})).apply(this,arguments)}function n(f,I,w){return c.apply(this,arguments)}function c(){return(c=(0,h.Z)(function*(f,I,w){const P=yield b(f,I,w,!0);return 0===P.length?null:y(P)})).apply(this,arguments)}function p(f,I){return S.apply(this,arguments)}function S(){return(S=(0,h.Z)(function*(f,I){return f.iterator(I).count()})).apply(this,arguments)}function b(f,I,w){return R.apply(this,arguments)}function R(){return(R=(0,h.Z)(function*(f,I,w,P=!1){const G=f.iterator(w),B=[],M={ticker:0};let H=yield G.next();for(;null!==H;){if(M.ticker++,w.aborted)throw new Error("Cancelled");M.ticker%100==0&&(M.ticker=0,yield new Promise(J=>{setTimeout(J,0)}));const k=I.calculateValue(H);null===k?!1===P&&(B[B.length]=k):B[B.length]=k,H=yield G.next()}return B})).apply(this,arguments)}function U(f,I){return W.apply(this,arguments)}function W(){return(W=(0,h.Z)(function*(f,I,w=1e3,P=null){const G=f.iterator(P),B=[],M={},H={ticker:0};let k=yield G.next();for(;null!==k;){if(H.ticker++,P.aborted)throw new Error("Cancelled");H.ticker%100==0&&(H.ticker=0,yield new Promise(V=>{setTimeout(V,0)}));const J=I.calculateValue(k);if(null!=J&&void 0===M[J]&&(B.push(J),M[J]=1),B.length>=w&&-1!==w)return B;k=yield G.next()}return B})).apply(this,arguments)}},87215:(Q,j,v)=>{v.d(j,{CJ:()=>ye,Cz:()=>ge,D$:()=>fe,ED:()=>R,G0:()=>ce,Gg:()=>f,LV:()=>W,Nm:()=>U,Sp:()=>H,TE:()=>n,U1:()=>pe,W4:()=>S,Y4:()=>Ee,cv:()=>he,e5:()=>B,f3:()=>_e,fS:()=>c,j2:()=>me,jU:()=>s,kK:()=>p,kQ:()=>Ie,og:()=>I,oq:()=>r,r3:()=>o,rd:()=>de,sz:()=>Se,uh:()=>b,wf:()=>J,z7:()=>a});var h=v(15861),Z=(v(29132),v(59289)),F=(v(49672),v(91179));function T(u){return Array.isArray(u)?u[0]?.spatialReference:u?.spatialReference}function N(u){return u&&(Array.isArray(u)?u.map(N):u.toJSON?u.toJSON():u)}function y(u){return Array.isArray(u)?u.map(_=>(0,F.im)(_)):(0,F.im)(u)}function g(u,_){let x;return Array.isArray(u)?x=u:(x=[],x.push(u),null!=_&&x.push(_)),x}let E;function C(){return O.apply(this,arguments)}function O(){return(O=(0,h.Z)(function*(){return E||(E=(0,Z.bA)("geometryEngineWorker",{strategy:"distributed"})),E})).apply(this,arguments)}function d(u,_){return m.apply(this,arguments)}function m(){return(m=(0,h.Z)(function*(u,_){return(yield C()).invoke("executeGEOperation",{operation:u,parameters:N(_)})})).apply(this,arguments)}function r(u,_){return i.apply(this,arguments)}function i(){return(i=(0,h.Z)(function*(u,_){return y(yield d("clip",[T(u),u,_]))})).apply(this,arguments)}function a(u,_){return l.apply(this,arguments)}function l(){return(l=(0,h.Z)(function*(u,_){return y(yield d("cut",[T(u),u,_]))})).apply(this,arguments)}function o(u,_){return d("contains",[T(u),u,_])}function s(u,_){return d("crosses",[T(u),u,_])}function n(u,_,x){return d("distance",[T(u),u,_,x])}function c(u,_){return d("equals",[T(u),u,_])}function p(u,_){return d("intersects",[T(u),u,_])}function S(u,_){return d("touches",[T(u),u,_])}function b(u,_){return d("within",[T(u),u,_])}function R(u,_){return d("disjoint",[T(u),u,_])}function U(u,_){return d("overlaps",[T(u),u,_])}function W(u,_,x){return d("relate",[T(u),u,_,x])}function f(u){return d("isSimple",[T(u),u])}function I(u){return w.apply(this,arguments)}function w(){return(w=(0,h.Z)(function*(u){return y(yield d("simplify",[T(u),u]))})).apply(this,arguments)}function B(u,_){return M.apply(this,arguments)}function M(){return(M=(0,h.Z)(function*(u,_){return y(yield d("difference",[T(u),u,_]))})).apply(this,arguments)}function H(u,_){return k.apply(this,arguments)}function k(){return(k=(0,h.Z)(function*(u,_){return y(yield d("symmetricDifference",[T(u),u,_]))})).apply(this,arguments)}function J(u,_){return V.apply(this,arguments)}function V(){return(V=(0,h.Z)(function*(u,_){return y(yield d("intersect",[T(u),u,_]))})).apply(this,arguments)}function ce(u){return z.apply(this,arguments)}function z(){return(z=(0,h.Z)(function*(u,_=null){const x=g(u,_);return y(yield d("union",[T(x),x]))})).apply(this,arguments)}function he(u,_,x,L,K,Y){return $.apply(this,arguments)}function $(){return($=(0,h.Z)(function*(u,_,x,L,K,Y){return y(yield d("offset",[T(u),u,_,x,L,K,Y]))})).apply(this,arguments)}function _e(u,_,x){return X.apply(this,arguments)}function X(){return(X=(0,h.Z)(function*(u,_,x,L=!1){const K=[T(u),u,_,x,L];return y(yield d("buffer",K))})).apply(this,arguments)}function de(u,_,x,L,K,Y){return q.apply(this,arguments)}function q(){return(q=(0,h.Z)(function*(u,_,x,L,K,Y){const Te=[T(u),u,_,x,L,K,Y];return y(yield d("geodesicBuffer",Te))})).apply(this,arguments)}function ne(u){return"xmin"in u?u.center:"x"in u?u:u.extent.center}function pe(u,_,x){return ae.apply(this,arguments)}function ae(){return(ae=(0,h.Z)(function*(u,_,x){if(null==u)throw new Error("Illegal Argument Exception");const L=u.spatialReference;x=x??ne(u);const K=u.constructor.fromJSON(yield d("rotate",[L,u,_,x]));return K.spatialReference=L,K})).apply(this,arguments)}function fe(u,_,x,L){return ue.apply(this,arguments)}function ue(){return(ue=(0,h.Z)(function*(u,_,x,L){return y(yield d("generalize",[T(u),u,_,x,L]))})).apply(this,arguments)}function ge(u,_,x){return le.apply(this,arguments)}function le(){return(le=(0,h.Z)(function*(u,_,x){return y(yield d("densify",[T(u),u,_,x]))})).apply(this,arguments)}function me(u,_,x){return oe.apply(this,arguments)}function oe(){return(oe=(0,h.Z)(function*(u,_,x,L=0){return y(yield d("geodesicDensify",[T(u),u,_,x,L]))})).apply(this,arguments)}function ye(u,_){return d("planarArea",[T(u),u,_])}function Se(u,_){return d("planarLength",[T(u),u,_])}function Ee(u,_,x){return d("geodesicArea",[T(u),u,_,x])}function Ie(u,_,x){return d("geodesicLength",[T(u),u,_,x])}}}]);