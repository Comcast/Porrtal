"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[676],{6189:(ne,O,s)=>{s.r(O),s.d(O,{default:()=>Te});var g=s(15861),t=s(17626),v=s(46160),R=s(46882),f=s(26584),u=s(58817),d=s(47877),p=s(63290),B=s(62208),N=s(99959),m=s(10699),T=s(21726),i=s(77712),w=(s(90912),s(68653)),o=s(76898),V=s(65234),b=s(44917),_=s(49410),S=s(20925),ae=s(50085),de=s(65088),ue=s(49286),pe=s(6647),ye=s(99555),K=s(10157),c=s(86810),ce=s(35948);s(85931);let A=class extends c.wq{constructor(){super(...arguments),this.type=null}};(0,t._)([(0,i.Cb)({type:String,readOnly:!0,json:{write:!0}})],A.prototype,"type",void 0),A=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterAuthoringInfo")],A);const ee=A;var W;let F=W=class extends c.wq{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new W({filterType:this.filterType,filterValues:(0,u.d9)(this.filterValues)})}};var D;(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],F.prototype,"filterType",void 0),(0,t._)([(0,i.Cb)({type:[String],json:{write:!0}})],F.prototype,"filterValues",void 0),F=W=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterAuthoringInfoType")],F);const ve=v.Z.ofType(F);let E=D=class extends c.wq{clone(){return new D({filterTypes:(0,u.d9)(this.filterTypes)})}};var J;(0,t._)([(0,i.Cb)({type:ve,json:{write:!0}})],E.prototype,"filterTypes",void 0),E=D=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],E);const fe=v.Z.ofType(E);let I=J=class extends ee{constructor(){super(...arguments),this.type="checkbox"}clone(){return new J({filterBlocks:(0,u.d9)(this.filterBlocks)})}};(0,t._)([(0,i.Cb)({type:["checkbox"]})],I.prototype,"type",void 0),(0,t._)([(0,i.Cb)({type:fe,json:{write:!0}})],I.prototype,"filterBlocks",void 0),I=J=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],I);const te=I;let M=class extends c.wq{};(0,t._)([(0,i.Cb)({readOnly:!0,json:{read:!1}})],M.prototype,"type",void 0),M=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterMode")],M);const Z=M;var G;let L=G=class extends Z{constructor(){super(...arguments),this.type="solid"}clone(){return new G}};(0,t._)([(0,i.Cb)({type:["solid"],readOnly:!0,json:{write:!0}})],L.prototype,"type",void 0),L=G=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterModeSolid")],L);const H=L;var X,me=s(55342),be=s(61261);let x=X=class extends Z{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new X({edges:(0,u.d9)(this.edges)})}};(0,t._)([(0,me.J)({wireFrame:"wire-frame"})],x.prototype,"type",void 0),(0,t._)([(0,i.Cb)(be.Z)],x.prototype,"edges",void 0),x=X=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterModeWireFrame")],x);const re=x;var z;let P=z=class extends Z{constructor(){super(...arguments),this.type="x-ray"}clone(){return new z}};(0,t._)([(0,i.Cb)({type:["x-ray"],readOnly:!0,json:{write:!0}})],P.prototype,"type",void 0),P=z=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterModeXRay")],P);const ie=P;var Q;const Se={nonNullable:!0,types:{key:"type",base:Z,typeMap:{solid:H,"wire-frame":re,"x-ray":ie}},json:{read:e=>{switch(e&&e.type){case"solid":return H.fromJSON(e);case"wireFrame":return re.fromJSON(e);case"x-ray":return ie.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let C=Q=class extends c.wq{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new H,this.title=""}clone(){return new Q({filterExpression:this.filterExpression,filterMode:(0,u.d9)(this.filterMode),title:this.title})}};var Y;(0,t._)([(0,i.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],C.prototype,"filterExpression",void 0),(0,t._)([(0,i.Cb)(Se)],C.prototype,"filterMode",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],C.prototype,"title",void 0),C=Q=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilterBlock")],C);const Be=v.Z.ofType(C);let h=Y=class extends c.wq{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,ce.D)(),this.name=null}clone(){return new Y({description:this.description,filterBlocks:(0,u.d9)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,u.d9)(this.filterAuthoringInfo)})}};(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],h.prototype,"description",void 0),(0,t._)([(0,i.Cb)({type:Be,json:{write:{enabled:!0,isRequired:!0}}})],h.prototype,"filterBlocks",void 0),(0,t._)([(0,i.Cb)({types:{key:"type",base:ee,typeMap:{checkbox:te}},json:{read:e=>"checkbox"===(e&&e.type)?te.fromJSON(e):null,write:!0}})],h.prototype,"filterAuthoringInfo",void 0),(0,t._)([(0,i.Cb)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],h.prototype,"id",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],h.prototype,"name",void 0),h=Y=(0,t._)([(0,o.j)("esri.layers.support.BuildingFilter")],h);const Fe=h;var Ie=s(84792),xe=s(47996),je=s(60330);let y=class extends c.wq{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,t._)([(0,i.Cb)({type:String})],y.prototype,"fieldName",void 0),(0,t._)([(0,i.Cb)({type:String})],y.prototype,"modelName",void 0),(0,t._)([(0,i.Cb)({type:String})],y.prototype,"label",void 0),(0,t._)([(0,i.Cb)({type:Number})],y.prototype,"min",void 0),(0,t._)([(0,i.Cb)({type:Number})],y.prototype,"max",void 0),(0,t._)([(0,i.Cb)({json:{read:e=>Array.isArray(e)&&(e.every(r=>"string"==typeof r)||e.every(r=>"number"==typeof r))?e.slice():null}})],y.prototype,"mostFrequentValues",void 0),(0,t._)([(0,i.Cb)({type:[Number]})],y.prototype,"subLayerIds",void 0),y=(0,t._)([(0,o.j)("esri.layers.support.BuildingFieldStatistics")],y);let j=class extends(xe.Z.LoadableMixin((0,je.v)(c.wq))){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(p.Z.getLogger(this.declaredClass).error("building summary statistics are not loaded"),null)}load(e){const r=(0,B.pC)(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(r)),Promise.resolve(this)}_fetchService(e){var r=this;return(0,g.Z)(function*(){const l=(yield(0,Ie.default)(r.url,{query:{f:"json"},responseType:"json",signal:e})).data;r.read(l,{origin:"service"})})()}};(0,t._)([(0,i.Cb)({constructOnly:!0,type:String})],j.prototype,"url",void 0),(0,t._)([(0,i.Cb)({readOnly:!0,type:[y],json:{read:{source:"summary"}}})],j.prototype,"fields",null),j=(0,t._)([(0,o.j)("esri.layers.support.BuildingSummaryStatistics")],j);const se=j;var $=s(13812),Oe=s(74711);const oe=v.Z.ofType(Fe),k=(0,u.d9)(S.Z.sublayersProperty);k.json.origins["web-scene"]={type:[_.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},k.json.origins["portal-item"]={type:[_.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}};let a=class extends((0,K.Vt)((0,de.Y)((0,ue.q)((0,pe.I)((0,ye.M)((0,N.R)((0,ae.V)(b.Z)))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new R.Z({getCollections:()=>[this.sublayers],getChildrenFunction:r=>"building-group"===r.type?r.sublayers:null}),this.sublayers=null,this._sublayerOverrides=null,this.filters=new oe,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.type="building-scene"}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:e??{}}destroy(){this.allSublayers.destroy()}readSublayers(e,r,l){const n=S.Z.readSublayers(e,r,l);return S.Z.forEachSublayer(n,q=>q.layer=this),this._sublayerOverrides&&(this.applySublayerOverrides(n,this._sublayerOverrides),this._sublayerOverrides=null),n}applySublayerOverrides(e,{overrides:r,context:l}){S.Z.forEachSublayer(e,n=>n.read(r.get(n.id),l))}readSublayerOverrides(e,r){const l=new Map;for(const n of e)null!=n&&"object"==typeof n&&"number"==typeof n.id?l.set(n.id,n):r.messages?.push(new f.Z("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:n}));return{overrides:l,context:r}}writeSublayerOverrides(e,r,l){const n=[];S.Z.forEachSublayer(this.sublayers,q=>{const le=q.write({},l);Object.keys(le).length>1&&n.push(le)}),n.length>0&&(r.sublayers=n)}writeUnappliedOverrides(e,r){r.sublayers=[],e.overrides.forEach(l=>{r.sublayers.push((0,u.d9)(l))})}write(e,r){return e=super.write(e,r),!r||"web-scene"!==r.origin&&"portal-item"!==r.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,r):this._sublayerOverrides&&this.writeUnappliedOverrides(this._sublayerOverrides,e)),e}read(e,r){if(super.read(e,r),r&&("web-scene"===r.origin||"portal-item"===r.origin)&&null!=e&&Array.isArray(e.sublayers)){const l=this.readSublayerOverrides(e.sublayers,r);this.sublayers?this.applySublayerOverrides(this.sublayers,l):this._sublayerOverrides=l}}readSummaryStatistics(e,r){if("string"==typeof r.statisticsHRef){const l=(0,T.v_)(this.parsedUrl?.path,r.statisticsHRef);return new se({url:l})}return null}set elevationInfo(e){this._set("elevationInfo",e),this._validateElevationInfo()}load(e){const r=(0,B.pC)(e)?e.signal:null,l=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(m.r9).then(()=>this._fetchService(r)).then(()=>this._fetchAssociatedFeatureService(r));return this.addResolvingPromise(l),Promise.resolve(this)}loadAll(){return(0,d.G)(this,e=>{S.Z.forEachSublayer(this.sublayers,r=>{"building-group"!==r.type&&e(r)}),this.summaryStatistics&&e(this.summaryStatistics)})}saveAs(e,r){var l=this;return(0,g.Z)(function*(){return l._debouncedSaveOperations(K.xp.SAVE_AS,{...r,getTypeKeywords:()=>l._getTypeKeywords(),portalItemLayerType:"building-scene"},e)})()}save(){var e=this;return(0,g.Z)(function*(){const r={getTypeKeywords:()=>e._getTypeKeywords(),portalItemLayerType:"building-scene"};return e._debouncedSaveOperations(K.xp.SAVE,r)})()}validateLayer(e){if(!e.layerType||"Building"!==e.layerType)throw new f.Z("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}_validateElevationInfo(){const e=this.elevationInfo;e&&("absolute-height"!==e.mode&&p.Z.getLogger(this.declaredClass).warn(".elevationInfo=","Building scene layers only support absolute-height elevation mode"),e.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression&&p.Z.getLogger(this.declaredClass).warn(".elevationInfo=","Building scene layers do not support featureExpressionInfo"))}_fetchAssociatedFeatureService(e){var r=this;return(0,g.Z)(function*(){const l=new Oe.W(r.parsedUrl,r.portalItem,r.apiKey,e);try{r.associatedFeatureServiceItem=yield l.fetchPortalItem()}catch(n){p.Z.getLogger(r.declaredClass).warn("Associated feature service item could not be loaded",n)}})()}};(0,t._)([(0,i.Cb)({type:["BuildingSceneLayer"]})],a.prototype,"operationalLayerType",void 0),(0,t._)([(0,i.Cb)({readOnly:!0})],a.prototype,"allSublayers",void 0),(0,t._)([(0,i.Cb)(k)],a.prototype,"sublayers",void 0),(0,t._)([(0,w.r)("service","sublayers")],a.prototype,"readSublayers",null),(0,t._)([(0,i.Cb)({type:oe,nonNullable:!0,json:{write:!0}})],a.prototype,"filters",void 0),(0,t._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"activeFilterId",void 0),(0,t._)([(0,i.Cb)({readOnly:!0,type:se})],a.prototype,"summaryStatistics",void 0),(0,t._)([(0,w.r)("summaryStatistics",["statisticsHRef"])],a.prototype,"readSummaryStatistics",null),(0,t._)([(0,i.Cb)({type:[String],json:{read:!1}})],a.prototype,"outFields",void 0),(0,t._)([(0,i.Cb)($.vg)],a.prototype,"fullExtent",void 0),(0,t._)([(0,i.Cb)({type:["show","hide","hide-children"]})],a.prototype,"listMode",void 0),(0,t._)([(0,i.Cb)((0,$.Lx)(V.Z))],a.prototype,"spatialReference",void 0),(0,t._)([(0,i.Cb)($.PV)],a.prototype,"elevationInfo",null),(0,t._)([(0,i.Cb)({json:{read:!1},readOnly:!0})],a.prototype,"type",void 0),(0,t._)([(0,i.Cb)()],a.prototype,"associatedFeatureServiceItem",void 0),a=(0,t._)([(0,o.j)("esri.layers.BuildingSceneLayer")],a);const Te=a},10023:(ne,O,s)=>{s.d(O,{V:()=>u,e:()=>R});var g=s(15861),t=s(62208),v=s(36630);function R(d){return f.apply(this,arguments)}function f(){return(f=(0,g.Z)(function*(d,p=d.popupTemplate){if((0,t.Wi)(p))return[];const B=yield p.getRequiredFields(d.fieldsIndex),{lastEditInfoEnabled:N}=p,{objectIdField:m,typeIdField:T,globalIdField:i,relationships:U}=d;if(B.includes("*"))return["*"];const w=N?yield(0,v.CH)(d):[],o=(0,v.Q0)(d.fieldsIndex,[...B,...w]);return T&&o.push(T),o&&m&&d.fieldsIndex.has(m)&&!o.includes(m)&&o.push(m),o&&i&&d.fieldsIndex.has(i)&&!o.includes(i)&&o.push(i),U&&U.forEach(V=>{const{keyField:b}=V;o&&b&&d.fieldsIndex.has(b)&&!o.includes(b)&&o.push(b)}),o})).apply(this,arguments)}function u(d,p){return d.popupTemplate?d.popupTemplate:(0,t.pC)(p)&&p.defaultPopupTemplateEnabled&&(0,t.pC)(d.defaultPopupTemplate)?d.defaultPopupTemplate:null}}}]);