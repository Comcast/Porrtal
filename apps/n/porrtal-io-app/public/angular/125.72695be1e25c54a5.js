"use strict";(self.webpackChunka_porrtal_io_app=self.webpackChunka_porrtal_io_app||[]).push([[125],{34013:(Te,ve,h)=>{h.d(ve,{I:()=>R,b:()=>L});var E=h(62208),ee=h(99770),Q=h(13934),K=h(78925),W=h(24255),$=h(10109),te=h(67022),he=h(33726),re=h(2166),z=h(95285),x=h(65787),N=h(17625),j=h(22355),y=h(35387),S=h(44835),I=h(16396);function L(C){const B=new j.kG,{vertex:V,fragment:D}=B;return(0,re.Sv)(V,C),B.include(W.w,C),B.attributes.add(I.T.POSITION,"vec3"),B.attributes.add(I.T.UV0,"vec2"),B.varyings.add("vpos","vec3"),C.hasMultipassTerrain&&B.varyings.add("depth","float"),V.uniforms.add(new z.A("textureCoordinateScaleFactor",b=>(0,E.pC)(b.texture)&&(0,E.pC)(b.texture.descriptor.textureCoordinateScaleFactor)?b.texture.descriptor.textureCoordinateScaleFactor:ee.O)),V.code.add(N.H`
    void main(void) {
      vpos = position;
      ${C.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),B.include(K.f5,C),B.include($.l,C),D.uniforms.add([new y.A("tex",b=>b.texture),new x.p("opacity",b=>b.opacity)]),B.varyings.add("vTexCoord","vec2"),C.output===Q.H.Alpha?D.code.add(N.H`
    void main() {
      discardBySlice(vpos);
      ${C.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${N.H.float(te.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(D.include(he.Y),D.code.add(N.H`
    void main() {
      discardBySlice(vpos);
      ${C.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${N.H.float(te.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${C.transparencyPassType===S.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),B}const R=Object.freeze(Object.defineProperty({__proto__:null,build:L},Symbol.toStringTag,{value:"Module"}))},93310:(Te,ve,h)=>{h.d(ve,{S:()=>C,b:()=>I});var E=h(4794),ee=h(81801),Q=h(13934),K=h(78925),W=h(24255),$=h(10109),te=h(67022),he=h(33726),re=h(2166),z=h(97139),x=h(69960),N=h(17625),j=h(22355),y=h(44835),S=h(16396);function I(B){const V=new j.kG,D=B.hasMultipassTerrain&&(B.output===Q.H.Color||B.output===Q.H.Alpha);V.include(W.w,B),V.include(ee.A,B),V.include(K.f5,B);const{vertex:b,fragment:G}=V;return G.include(he.Y),(0,re.Sv)(b,B),G.uniforms.add(new x.N("uColor",k=>k.color)),V.attributes.add(S.T.POSITION,"vec3"),V.varyings.add("vWorldPosition","vec3"),D&&V.varyings.add("depth","float"),B.screenSizeEnabled&&V.attributes.add(S.T.OFFSET,"vec3"),B.shadingEnabled&&((0,re._8)(b),V.attributes.add(S.T.NORMAL,"vec3"),V.varyings.add("vViewNormal","vec3")),b.code.add(N.H`
    void main(void) {
      vWorldPosition = ${B.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),B.shadingEnabled&&b.code.add(N.H`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),b.code.add(N.H`
    ${D?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),D&&V.include($.l,B),G.code.add(N.H`
    void main() {
      discardBySlice(vWorldPosition);
      ${D?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),B.shadingEnabled?(G.uniforms.add(new z.J("shadingDirection",k=>k.shadingDirection)),G.uniforms.add(new x.N("shadedColor",k=>function L(B,V){const D=1-B[3],b=B[3]+V[3]*D;return 0===b?(R[3]=b,R):(R[0]=(B[0]*B[3]+V[0]*V[3]*D)/b,R[1]=(B[1]*B[3]+V[1]*V[3]*D)/b,R[2]=(B[2]*B[3]+V[2]*V[3]*D)/b,R[3]=V[3],R)}(k.shadingTint,k.color))),G.code.add(N.H`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):G.code.add(N.H`vec4 finalColor = uColor;`),G.code.add(N.H`
      if (finalColor.a < ${N.H.float(te.b)}) {
        discard;
      }
      ${B.output===Q.H.Alpha?N.H`gl_FragColor = vec4(finalColor.a);`:""}

      ${B.output===Q.H.Color?N.H`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${B.transparencyPassType===y.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),V}const R=(0,E.c)(),C=Object.freeze(Object.defineProperty({__proto__:null,build:I},Symbol.toStringTag,{value:"Module"}))},60507:(Te,ve,h)=>{h.d(ve,{BK:()=>V,Jn:()=>te,RL:()=>re,VW:()=>$,W_:()=>R,jG:()=>C,tq:()=>I,vQ:()=>j,zx:()=>y});var E=h(62208),ee=h(29505);function Q(D){return D?C:B}function $(D,b){return function K(D,b){return(0,E.Wi)(b)||!b.mode?Q(D).mode:b.mode}(!!(0,E.pC)(D)&&D.hasZ,b)}function te(D,b){return function W(D,b){return(0,E.pC)(b)?b:Q(D)}(!!(0,E.pC)(D)&&D.hasZ,b)}function re(D){const b=function x(D){return D.layer&&"elevationInfo"in D.layer?D.layer.elevationInfo:null}(D),G=$(D.geometry,b);return{mode:G,offset:(0,E.pC)(b)&&"on-the-ground"!==G?(0,E.Pt)(b.offset,0)*(0,ee.Z7)((0,E.Pt)(b.unit,"meters")):0}}function j(D,b,G,k=null){return S(D,b.x,b.y,b.hasZ?b.z:0,b.spatialReference,G,k)}function y(D,b,G,k,me=null){return S(D,b[0],b[1],b.length>2?b[2]:0,G,k,me)}function S(D,b,G,k,me,Pe,ue=null){if((0,E.Wi)(Pe))return;const oe=(0,E.pC)(ue)?ue.mode:"absolute-height";if("on-the-ground"===oe)return 0;const{absoluteZ:Y}=I(b,G,k,me,D,Pe);return function L(D,b,G,k,me,Pe,ue,oe){const Y=(0,E.pC)(ue)&&(0,E.pC)(ue.offset)?ue.offset:0;switch(oe){case"absolute-height":return D-Y;case"relative-to-ground":return D-((0,E.Pt)(Pe.elevationProvider.getElevation(b,G,k,me,"ground"),0)+Y);case"relative-to-scene":return D-((0,E.Pt)(Pe.elevationProvider.getElevation(b,G,k,me,"scene"),0)+Y)}}(Y,b,G,k,me,D,ue,oe)}function I(D,b,G,k,me,Pe){const ue=(0,E.pC)(Pe.offset)?Pe.offset:0;switch(Pe.mode){case"absolute-height":return{absoluteZ:G+ue,elevation:0};case"on-the-ground":{const oe=(0,E.Pt)(me.elevationProvider.getElevation(D,b,0,k,"ground"),0);return{absoluteZ:oe,elevation:oe}}case"relative-to-ground":{const oe=(0,E.Pt)(me.elevationProvider.getElevation(D,b,G,k,"ground"),0);return{absoluteZ:G+oe+ue,elevation:oe}}case"relative-to-scene":{const oe=(0,E.Pt)(me.elevationProvider.getElevation(D,b,G,k,"scene"),0);return{absoluteZ:G+oe+ue,elevation:oe}}}}function R(D,b){if((0,E.Wi)(b))return!1;const{mode:G}=b;return(0,E.pC)(G)&&("scene"===D&&"relative-to-scene"===G||"ground"===D&&"absolute-height"!==G)}const C={mode:"absolute-height",offset:0},B={mode:"on-the-ground",offset:null};function V(D,b){return D===b||(0,E.pC)(D)&&(0,E.pC)(b)&&D.mode===b.mode&&D.offset===b.offset}},1437:(Te,ve,h)=>{h.d(ve,{p:()=>re});var E=h(17626),ee=h(54024),Q=h(62208),K=h(60330),W=h(77712),he=(h(85931),h(90912),h(76898));const re=z=>{let x=class extends((0,K.v)(z)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(N){this._userInteractive=N}get updating(){return!1}get visible(){return!(0,Q.pC)(this.parent)||this.parent.visible&&!this.parent.suspended}set visible(N){this._overrideIfSome("visible",N)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,ee.kB)(()=>this._interactiveViewModelCount--)}};return(0,E._)([(0,W.Cb)({readOnly:!0})],x.prototype,"type",void 0),(0,E._)([(0,W.Cb)({constructOnly:!0})],x.prototype,"analysis",void 0),(0,E._)([(0,W.Cb)({constructOnly:!0})],x.prototype,"parent",void 0),(0,E._)([(0,W.Cb)({constructOnly:!0})],x.prototype,"view",void 0),(0,E._)([(0,W.Cb)({type:Boolean})],x.prototype,"interactive",null),(0,E._)([(0,W.Cb)()],x.prototype,"_userInteractive",void 0),(0,E._)([(0,W.Cb)({readOnly:!0})],x.prototype,"updating",null),(0,E._)([(0,W.Cb)()],x.prototype,"visible",null),(0,E._)([(0,W.Cb)()],x.prototype,"_interactiveViewModelCount",void 0),x=(0,E._)([(0,he.j)("esri.views.3d.analysis.AnalysisView3D")],x),x}},54865:(Te,ve,h)=>{h.d(ve,{G:()=>K,e:()=>W});var E=h(62208),ee=h(55915),Q=h(53929);function K($,te,he,re=!1){const z=(0,ee.fM)($,te);return(0,E.Wi)(z)?null:(z.hasZ&&!re||!(0,E.pC)(he)||(z.z=(0,E.Pt)((0,Q.KO)(he,z),0)),z)}function W($,te,he){he.warnOnce(`Failed to project analysis geometry (id: '${$.id}'), projection from spatial reference (wkid: '${te.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}},45403:(Te,ve,h)=>{h.d(ve,{Z:()=>ye}),h(29132);var ee=h(94573),Q=h(61885),K=h(21286),W=h(62208),$=h(23841),te=h(52323),he=h(30217),re=h(550),z=h(28347),x=h(43703),N=h(67831),j=h(84161),y=h(28093),S=h(55915),I=h(12080),L=h(65401),R=h(13777),C=h(90014),B=h(70562),V=h(26242),D=h(84786),b=h(53929),G=h(26046),k=h(42743),me=h(59856),Pe=h(96867),ue=h(34103),oe=h(33786),Y=h(72642);class ye{constructor(_){this._camera=new me.V,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,x.c)(),this._worldFrame=null,this._renderLocation=(0,y.c)(),this._renderLocationDirty=!0,this._location=new Y.Z({x:0,y:0,z:0}),this._elevationAlignedLocation=new Y.Z,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=oe.jg.None,this._focused=!1,this.events=new Q.Z.EventEmitter,this._screenLocation={screenPointArray:(0,$.s1)(),renderScreenPointArray:(0,$.J$)(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=_.view.spatialReference;for(const P in _)this[P]=_[P];this.view.state&&this.view.state.camera&&this._camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(_){this._elevationInfo=_,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(_){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=_.slice(),this._updateEngineObject()}set available(_){_!==this._available&&(this._available=_,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:(0,te.IH)(()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()})}}set radius(_){_!==this._radius&&(this._radius=_,this._updateEngineObject())}get radius(){return this._radius}set worldSized(_){_!==this._worldSized&&(this._worldSized=_,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(_){Z(_)&&(this._screenLocationDirty=!0),(0,z.c)(this._modelTransform,_),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,x.c)()),function X(F,_,P){switch(F.viewingMode){case"local":return(0,z.i)(P),!0;case"global":{const U=(0,I.Iu)(F.renderCoordsHelper.spatialReference);(0,S.PR)(_,0,Ae,0,U.radius),(0,S.yH)((0,K.Vl)(Ae[0]),(0,K.Vl)(Ae[1]),P)}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(_){this.view.renderCoordsHelper.fromRenderCoords(_,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(_){(0,D.WG)(_,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(_){(0,D.WG)(_,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const _=(0,W.pC)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=_+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,D.D)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(_){_!==this._grabbing&&(this._grabbing=_,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(_){_!==this._hovering&&(this._hovering=_,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(_){_!==this._selected&&(this._selected=_,this._updateEngineObject(),this.events.emit("select-changed",{action:_?"select":"deselect"}))}get state(){return this._state}set state(_){_!==this._state&&(this._state=_,this._updateEngineObject())}updateStateEnabled(_,P){P?this.state|=_:this.state&=~_}_setFocused(_){_!==this._focused&&(this._focused=_,this.events.emit("focus-changed",{action:!0===_?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let _;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,Z(this._modelTransform)){const P=this._calculateModelTransformOffset(A);_=(0,j.a)(P,P,this.renderLocation)}else _=this.renderLocation;this._camera.projectToRenderScreen(_,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(_){this._applyObjectTransform=_,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(_,P){if(!this.available)return null;const U=(0,$.md)(_,se),H=this._getCollisionRadius(P),ie=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,N.k)(this.screenLocation.screenPointArray,U)<H*H)return this.screenLocation.renderScreenPointArray[2]+ie;break;case"line":{const q=this.collisionType.paths,ae=this._getWorldToScreenObjectScale(),ce=this._calculateObjectTransform(ae,Me),_e=H*this.screenLocation.pixelSize,pe=(0,G.u4)(this._camera,U,fe);if((0,W.Wi)(pe))return null;for(const Ee of q){if(0===Ee.length)continue;const ge=(0,j.m)(Ae,Ee[0],ce);for(let Ce=1;Ce<Ee.length;Ce++){const de=(0,j.m)(v,Ee[Ce],ce),De=(0,R.Gr)((0,R.zk)(ge,de,ne),pe);if(null!=De&&De<_e*_e){const be=(0,j.a)(V.WM.get(),ge,de);(0,j.g)(be,be,.5);const Re=(0,$.So)(V.WM.get());return this._camera.projectToRenderScreen(be,Re),Re[2]+ie}(0,j.c)(ge,de)}}break}case"disc":{const q=this.collisionType.direction,ae=this.collisionType.offset??y.Z,ce=this._getWorldToScreenObjectScale(),_e=this._calculateObjectTransform(ce,Me),pe=H*this.screenLocation.pixelSize,Ee=(0,G.u4)(this._camera,U,fe);if((0,W.Wi)(Ee))return null;const ge=(0,he.f)(J,_e),Ce=(0,j.t)(g,q,ge),de=(0,j.m)(d,ae,_e);(0,C.Yq)(de,Ce,Oe);const De=M;if((0,C.BR)(Oe,Ee,De)&&(0,j.d)(De,de)<pe*pe)return this.screenLocation.renderScreenPointArray[2]+ie;break}case"ribbon":{const{paths:q,direction:ae}=this.collisionType,ce=this._getWorldToScreenObjectScale(),_e=this._calculateObjectTransform(ce,Me),pe=H*this._camera.computeScreenPixelSizeAt(this.renderLocation),Ee=(0,G.u4)(this._camera,U,fe);if((0,W.Wi)(Ee))return null;const ge=(0,he.f)(J,_e),Ce=(0,j.t)(g,ae,ge),de=this._calculateModelTransformPosition(d);(0,C.Yq)(de,Ce,Oe);const De=M;if(!(0,C.BR)(Oe,Ee,De))break;for(const be of q){if(0===be.length)continue;const Re=(0,j.m)(Ae,be[0],_e);for(let Le=1;Le<be.length;Le++){const Se=(0,j.m)(v,be[Le],_e),Ie=(0,R.Jk)((0,R.zk)(Re,Se,ne),De);if(null!=Ie&&Ie<pe*pe){const je=(0,j.a)(V.WM.get(),Re,Se);(0,j.g)(je,je,.5);const We=(0,$.So)(V.WM.get());return this._camera.projectToRenderScreen(je,We),We[2]+ie}(0,j.c)(Re,Se)}}break}default:(0,ee.Bg)(this.collisionType)}return null}attach(_={manipulator3D:{}}){if(!this.view._stage)return;const P=_.manipulator3D;if((0,W.Wi)(P.engineLayerId)){const U=new ue.F({isPickable:!1,updatePolicy:k.jq.SYNC});this.view._stage.add(U),P.engineLayerId=U.id,this._engineLayer=U}else this.view._stage?.getObject&&(this._engineLayer=this.view._stage.getObject(P.engineLayerId));P.engineLayerReferences=(P.engineLayerReferences||0)+1,this._materialIdReferences=P.materialIdReferences,(0,W.Wi)(this._materialIdReferences)&&(this._materialIdReferences=new Map,P.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,S.Up)(this._location.spatialReference,this.view.spatialReference)||(this.location=new Y.Z({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(_={manipulator3D:{}}){const P=_.manipulator3D;P.engineLayerReferences--;const U=0===P.engineLayerReferences;U&&(P.engineLayerId=null),this._removeResourcesFromStage(U),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(_){(0,S.nF)(this.location,T,_.spatialReference),(0,L.Qn)(_.extent,T)&&(this.location=this._location)}_evaluateElevationAlignment(_=this.location){if((0,W.Wi)(this.elevationInfo))return!1;let P=null,U=0;const H=(0,W.Pt)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":P=(0,W.Pt)((0,b.KO)(this.view.elevationProvider,_,"ground"),0);break;case"relative-to-ground":U=(0,W.Pt)((0,b.KO)(this.view.elevationProvider,_,"ground"),0)+H;break;case"relative-to-scene":U=(0,W.Pt)((0,b.KO)(this.view.elevationProvider,_,"scene"),0)+H;break;case"absolute-height":U=H}return(U!==this._elevation.offset||P!==this._elevation.override)&&(this._elevation.offset=U,this._elevation.override=P,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const _=this._getWorldToScreenObjectScale(),P=Me;if(!0===this.autoScaleRenderObjects){const q=this._getFocusedSize(this._radius,this.focused)*_;this._calculateObjectTransform(q,P)}else this._calculateObjectTransform(_,P);const{objectsByState:U}=this._ensureEngineResources(),H=(this.focused?oe.Q9.Focused:oe.Q9.Unfocused)|(this.selected?oe.Q9.Selected:oe.Q9.Unselected),ie=this._noDisplayCount>0;for(const{stateMask:q,objects:ae}of U){if(ie){for(const ge of ae)ge.setVisible(!1);continue}const Ee=!((q&oe.jg.All)!==oe.jg.None)||(this.state&q)==(q&oe.jg.All);if((q&oe.Q9.All)!==oe.Q9.None&&(H&q)!=(q&oe.Q9.All)||!Ee)for(const ge of ae)ge.setVisible(!1);else for(const ge of ae)ge.setVisible(!0),ge.transformation=P}}_ensureEngineResources(){if((0,W.Wi)(this._engineResources)){const _=(0,W.Wg)(this._engineLayer),P=[],U=new Set;this.renderObjects.forEach(({material:ae})=>{U.has(ae)||(P.push(ae),U.add(ae))});const H=(ae,ce)=>{const{geometry:_e,material:pe,transform:Ee}=ce;Array.isArray(_e)?_e.forEach(ge=>ae.addGeometry(ge,pe,Ee)):ae.addGeometry(_e,pe,Ee)},ie=new Map;this._renderObjects.forEach(ae=>{const ce=new Pe.T({castShadow:!1});H(ce,ae);const _e=ae.stateMask||0,pe=ie.get(_e)||[];pe.push(ce),ie.set(_e,pe)});const q=[];ie.forEach((ae,ce)=>q.push({stateMask:ce,objects:ae})),this._engineResources={objectsByState:q,layer:_,materials:P}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||(0,W.Wi)(this._engineResources))return;const{objectsByState:_,layer:P,materials:U}=this._engineResources;U.forEach(H=>{const ie=(0,W.Wg)(this._materialIdReferences),q=ie.get(H.id)||0;0===q&&this.view._stage.add(H),ie.set(H.id,q+1)}),_.forEach(({objects:H})=>{P.addMany(H),this.view._stage.addMany(H)}),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(_=!1){if(!this._engineResourcesAddedToStage||(0,W.Wi)(this._engineResources)||!this.view._stage)return;const{objectsByState:P,layer:U,materials:H}=this._engineResources;P.forEach(({objects:ie})=>{U.removeMany(ie),this.view._stage.removeMany(ie)}),H.forEach(ie=>{const q=(0,W.Wg)(this._materialIdReferences),ae=q.get(ie.id);1===ae?(this.view._stage.remove(ie),q.delete(ie.id)):q.set(ie.id,ae-1)}),_&&this.view._stage.remove(U),this._engineResourcesAddedToStage=!1}_getCollisionRadius(_){return this._getFocusedSize(this.radius,!0)*("touch"===_?this.touchMultiplier:1)}_getFocusedSize(_,P){return _*(P?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(_){const P=this._getWorldToScreenObjectScale(),U=this._calculateObjectTransform(P,le);return(0,j.s)(_,U[12],U[13],U[14])}_calculateModelTransformOffset(_){const P=this._calculateModelTransformPosition(_);return(0,j.b)(_,P,this.renderLocation)}_calculateObjectTransform(_,P){return(0,z.s)(P,_,0,0,0,0,_,0,0,0,0,_,0,0,0,0,1),this._worldFrame&&(0,z.m)(P,P,this._worldFrame),(0,z.m)(P,P,this._modelTransform),P[12]+=this.renderLocation[0],P[13]+=this.renderLocation[1],P[14]+=this.renderLocation[2],P[15]=1,(0,W.pC)(this._applyObjectTransform)&&this._applyObjectTransform(P),P}get test(){let _=!1;if((0,W.pC)(this._engineResources))for(const P in this._engineResources.objectsByState){const U=this._engineResources.objectsByState[P];for(const H of U.objects)if(H.isVisible){_=!0;break}if(_)break}return{areAnyResourcesVisible:_}}}function Z(F){return 0!==F[12]||0!==F[13]||0!==F[14]}const se=(0,$.s1)(),ne=(0,R.Ue)(),fe=(0,B.Ue)(),J=(0,re.c)(),le=(0,x.c)(),Me=(0,x.c)(),Oe=(0,C.Ue)(),Ae=(0,y.c)(),v=(0,y.c)(),M=(0,y.c)(),g=(0,y.c)(),d=(0,y.c)(),A=(0,y.c)(),T=new Y.Z({x:0,y:0,z:0,spatialReference:null})},19142:(Te,ve,h)=>{h.d(ve,{Aq:()=>ue,Bz:()=>G,EA:()=>B,Gd:()=>Pe,Ju:()=>b,X9:()=>me,aD:()=>k});var E=h(28347),ee=h(84161),Q=h(28093),K=h(4794),W=h(26242),te=(h(84786),h(45403)),re=(h(67225),h(42743)),z=h(52107),x=h(57521),N=h(40723),j=h(16396),y=h(92972),S=h(79967),I=h(49580),L=h(92222),R=h(81040),C=h(33786);function B(Z,X=N.yD.OccludeAndTransparent,se=!0){const ne=(0,K.f)(Z[0],Z[1],Z[2],Z.length>3?Z[3]:1),fe=Z[3]<1;return se?new R.Q({color:ne,transparent:fe,writeDepth:!0,cullFace:re.Vr.Back,renderOccluded:X}):new y.E({color:ne,transparent:fe,writeDepth:!0,cullFace:re.Vr.Back,renderOccluded:X})}const D=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1,calloutColor:(0,Q.f)(1,.5,0)});function b(Z,X){const se=new te.Z({view:Z,autoScaleRenderObjects:!1,collisionPriority:1,metadata:X.metadata});return G(se,X),se}function G(Z,X){const se=X.material??new S.j({transparent:!0,writeDepth:!1,textureId:X.texture?.id,renderOccluded:N.yD.Opaque}),ne=X.focusMultiplier??D.focusMultiplier,fe=X.calloutLength??D.calloutLength,J=D.discRadius*(X.discScale??1),le=J*ne,Me=A=>{const T=[0,1,2,2,3,0];return new z.Z([[j.T.POSITION,{size:3,data:[fe-A,-A,0,fe+A,-A,0,fe+A,A,0,fe-A,A,0],exclusive:!0}],[j.T.UV0,{size:2,data:[0,0,1,0,1,1,0,1]}]],[[j.T.POSITION,T],[j.T.UV0,T]])},Oe=(0,x.rh)([[0,0,0],[fe-J,0,0]]),Ae=(0,x.rh)([[0,0,0],[fe-le,0,0]]),v=D.calloutColor,M=X.calloutWidth??D.calloutWidth,g=new(M>1?L.U:I.Y)({width:M,color:(0,K.f)(v[0],v[1],v[2],X.calloutOpacity??1),renderOccluded:N.yD.OccludeAndTransparent}),d=X.customStateMask??C.jg.None;Z.collisionType={type:"disc",direction:[0,0,1],offset:[fe,0,0]},Z.focusMultiplier=ne,Z.metadata=X.metadata,Z.radius=J,Z.renderObjects=[{geometry:Me(J),material:se,stateMask:C.Q9.Unfocused|d},{geometry:Oe,material:g,stateMask:C.Q9.Unfocused|d},{geometry:Me(le),material:se,stateMask:C.Q9.Focused|d},{geometry:Ae,material:g,stateMask:C.Q9.Focused|d}]}function k(Z,X,se,ne=C.jg.None){return new te.Z({view:Z,renderObjects:[{geometry:(0,x.PI)(1,32,32),material:B((0,K.f)(X[0],X[1],X[2],se??1)),stateMask:ne}]})}const me=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function Pe(Z,X,se,ne){const fe=(0,ee.b)(W.WM.get(),Z,se),J=ue(fe,(0,ee.f)(W.WM.get(),ne,fe),se,W.MP.get());(0,E.a)(J,J);const le=(0,ee.m)(W.WM.get(),X,J);return Math.atan2(le[1],le[0])}function ue(Z,X,se,ne){const fe=(0,ee.n)(W.WM.get(),Z),J=(0,ee.n)(W.WM.get(),X),le=(0,ee.f)(W.WM.get(),fe,J);return ne[0]=fe[0],ne[1]=fe[1],ne[2]=fe[2],ne[3]=0,ne[4]=J[0],ne[5]=J[1],ne[6]=J[2],ne[7]=0,ne[8]=le[0],ne[9]=le[1],ne[10]=le[2],ne[11]=0,ne[12]=se[0],ne[13]=se[1],ne[14]=se[2],ne[15]=1,ne}},87469:(Te,ve,h)=>{h.d(ve,{r:()=>x});var E=h(62208),ee=h(28347),Q=h(43703),K=h(84161),W=h(28093),$=h(67709),te=h(53928),he=h(79020),re=h(40723),z=h(92222);class x extends te._{constructor(y,S){super(y),this._hasExternalMaterial=!1,this._renderOccluded=re.yD.OccludeAndTransparent,this._width=1,this._color=(0,$.f)(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this._material=S,this._hasExternalMaterial=(0,E.pC)(S),this.applyProps(y)}setGeometryFromRenderSpacePoint(y,S=1e3){const I=[];I.push([[y[0]-S,y[1]+0,y[2]+0],[y[0]+S,y[1]+0,y[2]+0]]),I.push([[y[0]-0,y[1]-S,y[2]+0],[y[0]+0,y[1]+S,y[2]+0]]),I.push([[y[0]-0,y[1]+0,y[2]-S],[y[0]+0,y[1]+0,y[2]+S]]),this.geometry=I}setGeometryFromExtent(y){const S=this.view.spatialReference,I=(0,W.c)(),L=(0,W.c)(),R=100,C=[];(0,K.s)(I,y[0],y[1],R),this.view.renderCoordsHelper.toRenderCoords(I,S,L),C.push([L[0],L[1],L[2]]),(0,K.s)(I,y[2],y[1],R),this.view.renderCoordsHelper.toRenderCoords(I,S,L),C.push([L[0],L[1],L[2]]),(0,K.s)(I,y[2],y[3],R),this.view.renderCoordsHelper.toRenderCoords(I,S,L),C.push([L[0],L[1],L[2]]),(0,K.s)(I,y[0],y[3],R),this.view.renderCoordsHelper.toRenderCoords(I,S,L),C.push([L[0],L[1],L[2]]),(0,K.s)(I,y[0],y[1],R),this.view.renderCoordsHelper.toRenderCoords(I,S,L),C.push([L[0],L[1],L[2]]),(0,K.s)(I,y[0],y[1],R),this.view.renderCoordsHelper.toRenderCoords(I,S,L),C.push([L[0],L[1],L[2]]),this.geometry=[C]}setGeometryFromFrustum(y){const S=[];y.lines.forEach(I=>{S.push([I.origin[0],I.origin[1],I.origin[2]]),S.push([I.endpoint[0],I.endpoint[1],I.endpoint[2]])}),this.geometry=[S]}setGeometryFromBoundedPlane(y){const S=[],I=y.origin,L=y.basis1,R=y.basis2,C=.5,B=(0,W.c)(),V=(0,W.c)(),D=(0,W.c)(),b=(0,W.c)();B[0]=I[0]-L[0]*C-R[0]*C,B[1]=I[1]-L[1]*C-R[1]*C,B[2]=I[2]-L[2]*C-R[2]*C,V[0]=I[0]-L[0]*C+R[0]*C,V[1]=I[1]-L[1]*C+R[1]*C,V[2]=I[2]-L[2]*C+R[2]*C,D[0]=I[0]+L[0]*C+R[0]*C,D[1]=I[1]+L[1]*C+R[1]*C,D[2]=I[2]+L[2]*C+R[2]*C,b[0]=I[0]+L[0]*C-R[0]*C,b[1]=I[1]+L[1]*C-R[1]*C,b[2]=I[2]+L[2]*C-R[2]*C,S.push([B[0],B[1],B[2]]),S.push([V[0],V[1],V[2]]),S.push([D[0],D[1],D[2]]),S.push([b[0],b[1],b[2]]),S.push([B[0],B[1],B[2]]),this.geometry=[S]}setGeometryFromSegment(y){const S=y.endRenderSpace;this.transform=(0,ee.f)(N,S);const{points:I}=y.createRenderGeometry(S,this.view.renderCoordsHelper);this.geometry=[I]}setGeometryFromSegments(y,S=W.Z){this.transform=(0,ee.f)(N,S),this.geometry=y.map(I=>I.createRenderGeometry(S,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return(0,E.Wi)(this._geometry)?null:this._geometry.map(y=>y.map(S=>(0,K.m)((0,W.c)(),S,this.transform)))}get renderOccluded(){return(0,E.pC)(this._material)?this._material.parameters.renderOccluded:this._renderOccluded}set renderOccluded(y){this._renderOccluded=y,(0,E.pC)(this._material)&&this._material.setParameters({renderOccluded:y})}get geometry(){return this._geometry}set geometry(y){this._geometry=y,this.recreateGeometry()}get width(){return(0,E.pC)(this._material)?this._material.parameters.width:this._width}set width(y){this._width=y,(0,E.pC)(this._material)&&this._material.setParameters({width:y})}get color(){return(0,E.pC)(this._material)?this._material.parameters.color:this._color}set color(y){this._color=(0,$.a)(y),(0,E.pC)(this._material)&&this._material.setParameters({color:this._color})}get innerWidth(){return(0,E.pC)(this._material)?this._material.parameters.innerWidth:this._innerWidth}set innerWidth(y){this._innerWidth=y,(0,E.pC)(this._material)&&this._material.setParameters({innerWidth:y})}get innerColor(){return(0,E.pC)(this._material)?this._material.parameters.innerColor:this._innerColor}set innerColor(y){this._innerColor=(0,E.pC)(y)?(0,$.a)(y):y,(0,E.pC)(this._material)&&this._material.setParameters({innerColor:this._innerColor})}get stipplePattern(){return(0,E.pC)(this._material)?this._material.parameters.stipplePattern:this._stipplePattern}set stipplePattern(y){this._stipplePattern=y,(0,E.pC)(this._material)&&this._material.setParameters({stipplePattern:y})}get stippleOffColor(){return(0,E.pC)(this._material)?this._material.parameters.stippleOffColor:this._stippleOffColor}set stippleOffColor(y){this._stippleOffColor=(0,E.pC)(y)?(0,$.a)(y):null,(0,E.pC)(this._material)&&this._material.setParameters({stippleOffColor:this._stippleOffColor})}get stipplePreferContinuous(){return(0,E.pC)(this._material)?this._material.parameters.stipplePreferContinuous:this._stipplePreferContinuous}set stipplePreferContinuous(y){this._stipplePreferContinuous=y,(0,E.pC)(this._material)&&this._material.setParameters({stipplePreferContinuous:y})}get writeDepthEnabled(){return(0,E.pC)(this._material)?this._material.parameters.writeDepth:this._writeDepthEnabled}set writeDepthEnabled(y){this._writeDepthEnabled=y,(0,E.pC)(this._material)&&this._material.setParameters({writeDepth:y})}get falloff(){return(0,E.pC)(this._material)?this._material.parameters.falloff:this._falloff}set falloff(y){this._falloff=y,(0,E.pC)(this._material)&&this._material.setParameters({falloff:y})}get polygonOffset(){return(0,E.pC)(this._material)?this._material.parameters.hasPolygonOffset:this._polygonOffset}set polygonOffset(y){this._polygonOffset=y,(0,E.pC)(this._material)&&this._material.setParameters({hasPolygonOffset:y})}createExternalResources(){this._hasExternalMaterial||(this._material=new z.U({width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}))}destroyExternalResources(){this._hasExternalMaterial||(this._material=null)}createGeometries(y){for(const S of(0,he.c0)(this.geometry)){const I=(0,he.YU)(S);y.addGeometry(I,(0,E.Wg)(this._material))}}forEachExternalMaterial(y){this._hasExternalMaterial||y((0,E.Wg)(this._material))}}const N=(0,Q.c)()},53928:(Te,ve,h)=>{h.d(ve,{_:()=>he});var E=h(62208),ee=h(28347),Q=h(43703),K=h(68604),W=h(42743),$=h(96867),te=h(34103);class he extends K.l{constructor(z){super(z.view),this._resources=null,this._transform=(0,Q.c)()}get object(){return(0,E.pC)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(z){(0,ee.c)(this._transform,z),(0,E.pC)(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if((0,E.Wi)(this._resources))return;const z=this._resources.object,x=this.view._stage;x.removeMany(z.geometries),z.removeAllGeometries(),this.createGeometries(z),this.visible||z.setVisible(this.visible),x.addMany(z.geometries)}createResources(){this.destroyResources();const z=this.view._stage;if(!z)return;const x=new te.F({isPickable:!1,updatePolicy:W.jq.SYNC});z.add(x);const N=new $.T({castShadow:!1});N.transformation=this._transform,this.createExternalResources(),this.createGeometries(N),z.addMany(N.geometries),this.forEachExternalMaterial(j=>z.add(j)),z.add(N),x.add(N),this.visible||N.setVisible(!1),this._resources={layer:x,object:N}}destroyResources(){const z=this.view._stage;!(0,E.Wi)(this._resources)&&z&&(z.remove(this._resources.object),z.remove(this._resources.layer),this.forEachExternalMaterial(x=>{z.remove(x),x.dispose()}),z.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(z){(0,E.Wi)(this._resources)||this._resources.object.setVisible(z)}}},68604:(Te,ve,h)=>{h.d(ve,{l:()=>ee});var E=h(32917);class ee{constructor(K){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=K,this._handle=(0,E.YP)(()=>this.view.ready,W=>{this._resourcesCreated&&(W?this._createResources():this._destroyResources())})}applyProps(K){let W=!1;for(const $ in K)$ in this?"attached"===$?W=K[$]:this[$]=K[$]:console.error("Cannot set unknown property",$);this.attached=W}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(K){K!==this._attached&&this.view._stage&&(this._attached=K,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(K){K!==this._visible&&(this._visible=K,this.attached&&this.updateVisibility(K))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},81801:(Te,ve,h)=>{h.d(ve,{A:()=>K});var E=h(2166),ee=h(65787),Q=h(17625);function K(W,$){if(!$.screenSizeEnabled)return;const te=W.vertex;(0,E.hY)(te,$),te.uniforms.add(new ee.p("perScreenPixelRatio",(he,re)=>re.camera.perScreenPixelRatio)),te.uniforms.add(new ee.p("screenSizeScale",he=>he.screenSizeScale)),te.code.add(Q.H`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},79967:(Te,ve,h)=>{h.d(ve,{j:()=>me});var E=h(13934),ee=h(42743),Q=h(33470),K=h(40723),W=h(88569),$=h(5894),te=h(60909),he=h(57623),re=h(17626),x=(h(17625),h(651)),N=h(91056),j=h(87601),y=h(39114),S=h(12407),I=h(64127),L=h(44835),R=h(41528),C=h(34013),B=h(67969),V=h(2078);class b extends N.A{initializeProgram(Y){return new S.$(Y.rctx,b.shader.get().build(this.configuration),y.i)}_setPipelineState(Y,ye){const Z=this.configuration,X=Y===L.A.NONE,se=Y===L.A.FrontFace;return(0,V.sm)({blending:Z.output!==E.H.Color&&Z.output!==E.H.Alpha||!Z.transparent?null:X?G:(0,W.j7)(Y),culling:(0,V.zp)(Z.cullFace),depthTest:{func:(0,W.Bh)(Y)},depthWrite:X?Z.writeDepth&&V.LZ:(0,W.K5)(Y),colorWrite:V.BK,stencilWrite:Z.hasOccludees?I.s3:null,stencilTest:Z.hasOccludees?ye?I.eD:I.RY:null,polygonOffset:X||se?null:(0,W.je)(Z.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(Y,ye){return ye?this._occludeePipelineState:super.getPipelineState(Y,ye)}}b.shader=new x.J(C.I,()=>h.e(8586).then(h.bind(h,18586)));const G=(0,V.if)(B.zi.ONE,B.zi.ONE_MINUS_SRC_ALPHA);class k extends R.W{constructor(){super(...arguments),this.output=E.H.Color,this.cullFace=ee.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=L.A.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,re._)([(0,j.o)({count:E.H.COUNT})],k.prototype,"output",void 0),(0,re._)([(0,j.o)({count:ee.Vr.COUNT})],k.prototype,"cullFace",void 0),(0,re._)([(0,j.o)()],k.prototype,"hasSlicePlane",void 0),(0,re._)([(0,j.o)()],k.prototype,"transparent",void 0),(0,re._)([(0,j.o)()],k.prototype,"enableOffset",void 0),(0,re._)([(0,j.o)()],k.prototype,"writeDepth",void 0),(0,re._)([(0,j.o)()],k.prototype,"hasOccludees",void 0),(0,re._)([(0,j.o)({count:L.A.COUNT})],k.prototype,"transparencyPassType",void 0),(0,re._)([(0,j.o)()],k.prototype,"hasMultipassTerrain",void 0),(0,re._)([(0,j.o)()],k.prototype,"cullAboveGround",void 0);class me extends K.F5{constructor(Y){super(Y,new ue),this.supportsEdges=!0,this._configuration=new k}getConfiguration(Y,ye){return this._configuration.output=Y,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=ye.transparencyPassType,this._configuration.enableOffset=ye.camera.relativeElevation<W.ve,this._configuration.hasMultipassTerrain=ye.multipassTerrain.enabled,this._configuration.cullAboveGround=ye.multipassTerrain.cullAboveGround,this._configuration}intersect(Y,ye,Z,X,se,ne,fe){(0,he.Bw)(Y,ye,X,se,ne,void 0,fe)}requiresSlot(Y,ye){return!(ye!==E.H.Color&&ye!==E.H.Alpha&&ye!==E.H.Highlight||Y!==$.r.DRAPED_MATERIAL&&(ye===E.H.Highlight?Y!==$.r.OPAQUE_MATERIAL:Y!==(this.parameters.transparent?this.parameters.writeDepth?$.r.TRANSPARENT_MATERIAL:$.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:$.r.OPAQUE_MATERIAL)))}createGLMaterial(Y){return new Pe(Y)}createBufferWriter(){return new te.G_(te.W1)}}class Pe extends Q.F{constructor(Y){super({...Y,...Y.material.parameters})}_updateParameters(Y){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(b,Y)}_updateOccludeeState(Y){Y.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:Y.hasOccludees}),this._updateParameters(Y))}beginSlot(Y){return this._output!==E.H.Color&&this._output!==E.H.Alpha||this._updateOccludeeState(Y),this._updateParameters(Y)}}class ue extends K.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=ee.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}},81040:(Te,ve,h)=>{h.d(ve,{Q:()=>Y});var E=h(84161),ee=h(28093),Q=h(4794),K=h(5548),W=h(60479),$=h(19625),te=h(13934),he=h(42743),re=h(60881),z=h(40723),x=h(5894),N=h(2282),j=h(16396),y=h(42037),S=h(57623),I=h(17626),L=h(651),R=h(91056),C=h(87601),B=h(88569),V=h(12407),D=h(44835),b=h(41528),G=h(93310),k=h(67969),me=h(2078);class Pe extends R.A{initializeProgram(J){return new V.$(J.rctx,Pe.shader.get().build(this.configuration),oe)}_setPipelineState(J){const le=this.configuration,Me=J===D.A.NONE,Oe=J===D.A.FrontFace;return(0,me.sm)({blending:le.output!==te.H.Color&&le.output!==te.H.Alpha||!le.transparent?null:Me?B.wu:(0,B.j7)(J),culling:(0,me.zp)(le.cullFace),depthTest:{func:Oe?k.wb.LESS:le.shadingEnabled?k.wb.LEQUAL:k.wb.LESS},depthWrite:Me?le.writeDepth&&me.LZ:(0,B.K5)(J),colorWrite:me.BK,polygonOffset:Me||Oe?null:B.E0})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}Pe.shader=new L.J(G.S,()=>h.e(8271).then(h.bind(h,88271)));class ue extends b.W{constructor(){super(...arguments),this.output=te.H.Color,this.cullFace=he.Vr.None,this.transparencyPassType=D.A.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,I._)([(0,C.o)({count:te.H.COUNT})],ue.prototype,"output",void 0),(0,I._)([(0,C.o)({count:he.Vr.COUNT})],ue.prototype,"cullFace",void 0),(0,I._)([(0,C.o)({count:D.A.COUNT})],ue.prototype,"transparencyPassType",void 0),(0,I._)([(0,C.o)()],ue.prototype,"hasSlicePlane",void 0),(0,I._)([(0,C.o)()],ue.prototype,"transparent",void 0),(0,I._)([(0,C.o)()],ue.prototype,"writeDepth",void 0),(0,I._)([(0,C.o)()],ue.prototype,"screenSizeEnabled",void 0),(0,I._)([(0,C.o)()],ue.prototype,"shadingEnabled",void 0),(0,I._)([(0,C.o)()],ue.prototype,"hasMultipassTerrain",void 0),(0,I._)([(0,C.o)()],ue.prototype,"cullAboveGround",void 0);const oe=new Map([[j.T.POSITION,0],[j.T.NORMAL,1],[j.T.OFFSET,2]]);class Y extends z.F5{constructor(J){super(J,new Z),this.supportsEdges=!0,this._configuration=new ue,this._vertexAttributeLocations=oe}getConfiguration(J,le){return this._configuration.output=J,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=le.transparencyPassType,this._configuration.hasMultipassTerrain=le.multipassTerrain.enabled,this._configuration.cullAboveGround=le.multipassTerrain.cullAboveGround,this._configuration}intersect(J,le,Me,Oe,Ae,v,M){if(this.parameters.screenSizeEnabled){const g=J.vertexAttributes.get(j.T.OFFSET),d={applyToVertex:(A,T,F,_)=>{const P=(0,E.s)(se,g.data[3*_+0],g.data[3*_+1],g.data[3*_+2]),U=(0,E.s)(ne,A,T,F);return(0,E.g)(P,P,this.parameters.screenSizeScale*Oe.camera.computeRenderPixelSizeAt(P)),(0,E.a)(U,U,P),[U[0],U[1],U[2]]},applyToAabb:A=>{const T=(0,K.be)(A,se);return(0,K.bA)(A,this.parameters.screenSizeScale*Oe.camera.computeRenderPixelSizeAt(T))}};(0,S.Bw)(J,le,Oe,Ae,v,d,M)}else(0,S.Bw)(J,le,Oe,Ae,v,void 0,M)}requiresSlot(J,le){if(le===te.H.Highlight)return J===x.r.OPAQUE_MATERIAL;if(le===te.H.Color||le===te.H.Alpha||le===te.H.ObjectAndLayerIdColor){let Me=x.r.OPAQUE_MATERIAL;return this.parameters.transparent&&(Me=this.parameters.writeDepth?x.r.TRANSPARENT_MATERIAL:x.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),J===Me||J===x.r.DRAPED_MATERIAL}return!1}createGLMaterial(J){return new ye(J)}createBufferWriter(){return new X(this.parameters.screenSizeEnabled)}}class ye extends re.Z{beginSlot(J){return this.ensureTechnique(Pe,J)}}class Z extends z.Mt{constructor(){super(...arguments),this.color=(0,Q.f)(1,1,1,1),this.shadingTint=(0,Q.f)(0,0,0,.25),this.shadingDirection=(0,E.n)((0,ee.c)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=he.Vr.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class X{constructor(J){this.screenSizeEnabled=J;const le=(0,$.U$)().vec3f(j.T.POSITION).vec3f(j.T.NORMAL);this.screenSizeEnabled&&le.vec3f(j.T.OFFSET),this.vertexBufferLayout=le}allocate(J){return this.vertexBufferLayout.createBuffer(J)}elementCount(J){return J.indices.get(j.T.POSITION).length}write(J,le,Me,Oe,Ae){if((0,y.NK)(Me,this.vertexBufferLayout,J,le,Oe,Ae),this.screenSizeEnabled){if(!Me.vertexAttributes.has(j.T.OFFSET))throw new Error(`${j.T.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const v=Me.vertexAttributes.get(j.T.OFFSET),M=Me.indices.get(j.T.OFFSET);(0,N.hu)(3===v.size);const g=Oe.getField(j.T.OFFSET,W.ct);if(!g)throw new Error("unable to acquire view for "+j.T.OFFSET);(0,y.ho)(M,v.data,le,g,Ae)}}}}const se=(0,ee.c)(),ne=(0,ee.c)()},95925:(Te,ve,h)=>{h.d(ve,{Er:()=>$,Lp:()=>te,Yq:()=>z});var E=h(15861),ee=h(59213),Q=h(62208),K=h(10699),W=h(32917);function $(x,N){x.interactive=!0;const{tool:j,view:y}=x;y.activeTool=j;let S=(0,K.fu)(N,()=>{y.activeTool===j&&(y.activeTool=null)});return(0,ee.vr)(function(){var I=(0,E.Z)(function*(L){yield(0,W.N1)(()=>(0,Q.Wi)(j)||!j.active,L),S=(0,Q.hw)(S)});return function(L){return I.apply(this,arguments)}}(),N)}function te(x,N){return(0,W.YP)(()=>x.interactive,()=>function he(x,N){x.interactive?function re(x,N){z(x);const{view:j,analysis:y}=x,S=new N({view:j,analysis:y,analysisViewData:x});x.tool=S,j.tools.add(S)}(x,N):z(x)}(x,N),W.tX)}function z(x){const{view:N,tool:j}=x;(0,Q.Wi)(j)||(N.tools.remove(j),x.tool=null)}},58997:(Te,ve,h)=>{h.d(ve,{f:()=>I});var j,L,E=h(17626),ee=h(32917),Q=h(77712),$=(h(85931),h(90912),h(76898)),te=h(14517),he=h(63290),re=h(62208),z=h(10699),x=h(33786),N=h(46160);(L=j||(j={}))[L.WhenToolEditable=0]="WhenToolEditable",L[L.WhenToolNotEditable=1]="WhenToolNotEditable",L[L.Always=2]="Always";class y{constructor(){this._isToolEditable=!0,this._manipulators=new N.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(R){this._isToolEditable=R}get length(){return this._manipulators.length}add(R,C=j.WhenToolEditable){this.addMany([R],C)}addMany(R,C=j.WhenToolEditable){for(const B of R){const V={manipulator:B,visibilityPredicate:C,attached:!1};this._manipulators.add(V),this._attached&&this._updateManipulatorAttachment(V)}}remove(R){for(let C=0;C<this._manipulators.length;C++)if(this._manipulators.getItemAt(C).manipulator===R){const B=this._manipulators.splice(C,1)[0];this._detachManipulator(B);break}}removeAll(){this._manipulators.forEach(R=>{this._detachManipulator(R)}),this._manipulators.removeAll()}attach(){this._manipulators.forEach(R=>{this._updateManipulatorAttachment(R)}),this._attached=!0}detach(){this._manipulators.forEach(R=>{this._detachManipulator(R)}),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach(({manipulator:R})=>{R.destroy&&R.destroy()}),this._manipulators.destroy(),this._resourceContexts=null}on(R,C){return this._manipulators.on(R,B=>{C(B)})}forEach(R){for(const C of this._manipulators.items)R(C)}some(R){return this._manipulators.items.some(R)}toArray(){const R=[];return this.forEach(C=>R.push(C.manipulator)),R}intersect(R,C){let B=null,V=Number.MAX_VALUE;return this._manipulators.forEach(({manipulator:D,attached:b})=>{if(!b||!D.interactive)return;const G=D.intersectionDistance(R,C);(0,re.pC)(G)&&G<V&&(V=G,B=D)}),B}_updateManipulatorAttachment(R){this._isManipulatorItemVisible(R)?this._attachManipulator(R):this._detachManipulator(R)}_attachManipulator(R){R.attached||(R.manipulator.attach&&R.manipulator.attach(this._resourceContexts),R.attached=!0)}_detachManipulator(R){if(!R.attached)return;const C=R.manipulator;C.grabbing=!1,C.dragging=!1,C.hovering=!1,C.selected=!1,C.detach&&C.detach(this._resourceContexts),R.attached=!1}_isManipulatorItemVisible(R){return R.visibilityPredicate===j.Always||(this._isToolEditable?R.visibilityPredicate===j.WhenToolEditable:R.visibilityPredicate===j.WhenToolNotEditable)}}let S=class extends te.Z{constructor(L){super(L),this.manipulators=new y,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[x.bH.MANAGER,!0],[x.bH.USER,!0]]),this._creationFinishedResolver=(0,z.hh)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(L){this._get("visible")!==L&&(this._set("visible",L),this._syncVisible())}get editable(){return this.getEditableFlag(x.bH.USER)}set editable(L){this.setEditableFlag(x.bH.USER,L)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){(0,re.Wi)(this.view)?he.Z.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(L){this.onInputEvent(L)}handleInputEventAfter(L){this.onInputEventAfter(L)}setEditableFlag(L,R){this._editableFlags.set(L,R),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),L===x.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(L){return this._editableFlags.get(L)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(L){}onInputEventAfter(L){}get internallyEditable(){return this.getEditableFlag(x.bH.USER)&&this.getEditableFlag(x.bH.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,E._)([(0,Q.Cb)({constructOnly:!0})],S.prototype,"view",void 0),(0,E._)([(0,Q.Cb)({readOnly:!0})],S.prototype,"active",null),(0,E._)([(0,Q.Cb)({value:!0})],S.prototype,"visible",null),(0,E._)([(0,Q.Cb)({value:!0})],S.prototype,"editable",null),(0,E._)([(0,Q.Cb)({readOnly:!0})],S.prototype,"manipulators",void 0),(0,E._)([(0,Q.Cb)({readOnly:!0})],S.prototype,"updating",null),(0,E._)([(0,Q.Cb)()],S.prototype,"cursor",null),(0,E._)([(0,Q.Cb)({readOnly:!0})],S.prototype,"automaticManipulatorSelection",void 0),(0,E._)([(0,Q.Cb)()],S.prototype,"hasFocusedManipulators",null),(0,E._)([(0,Q.Cb)()],S.prototype,"hasGrabbedManipulators",void 0),(0,E._)([(0,Q.Cb)()],S.prototype,"hasHoveredManipulators",void 0),(0,E._)([(0,Q.Cb)()],S.prototype,"firstGrabbedManipulator",void 0),(0,E._)([(0,Q.Cb)({readOnly:!0})],S.prototype,"created",void 0),(0,E._)([(0,Q.Cb)({readOnly:!0})],S.prototype,"removeIncompleteOnCancel",void 0),S=(0,E._)([(0,$.j)("esri.views.interactive.InteractiveToolBase")],S);let I=class extends S{constructor(L){super(L)}initialize(){this.addHandles((0,ee.YP)(()=>this.analysisViewData.visible,L=>this.visible=L,ee.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};(0,E._)([(0,Q.Cb)({constructOnly:!0})],I.prototype,"analysis",void 0),(0,E._)([(0,Q.Cb)()],I.prototype,"analysisViewData",void 0),I=(0,E._)([(0,$.j)("esri.views.interactive.AnalysisToolBase")],I)},30260:(Te,ve,h)=>{h.d(ve,{hM:()=>Oe,Xd:()=>D,di:()=>Z}),h(29132);var ee=h(58817),K=(h(21286),h(62208));function D(v,M){return v.events.on("drag",function V(v,M){let g=null,d=null;return A=>{if("cancel"===A.action)return void((0,K.pC)(d)&&(d.execute({action:"cancel"}),g=null,d=null));const T={action:A.action,screenStart:A.start,screenEnd:A.screenPoint};"start"===A.action&&(0,K.Wi)(g)&&(g=new Oe,d=new Oe,M(v,g,d,A.pointerType,T)),(0,K.pC)(g)&&g.execute(T),"end"===A.action&&(0,K.pC)(g)&&(g=null,d=null)}}(v,M))}function Z(v,M){const g=new Map;for(const d of M)g.set(d,(0,ee.d9)(v[d]));return d=>(g.forEach((A,T)=>{v[T]=A}),d)}h(28093),h(55915),h(84786),h(60507),h(59617),h(65401),h(32442),h(25748),h(72642);class Oe{constructor(){this.execute=()=>{}}next(M,g=new Oe){return(0,K.pC)(M)&&(this.execute=d=>{const A=M(d);(0,K.pC)(A)&&g.execute(A)}),g}}}}]);